-- üîÑ BlackRent Database Migration ROLLBACK: REMOVE {{fieldLabel}} FIELD
-- Autor: Field Scaffolder  
-- D√°tum: {{currentDate}}
-- Cieƒæ: Odstr√°ni≈• pole {{fieldName}} z tabuƒæky {{table}}

BEGIN;

-- Backup d√°t pred odstr√°nen√≠m (pre pr√≠pad potreby)
CREATE TABLE IF NOT EXISTS migration_backup_{{timestamp}} AS
SELECT id, {{fieldName}}
FROM {{table}}
WHERE {{fieldName}} IS NOT NULL;

-- Odstr√°≈à index
{{#if (eq type 'string')}}
DROP INDEX IF EXISTS idx_{{table}}_{{fieldName}};
{{/if}}

-- Odstr√°≈à stƒ∫pec
ALTER TABLE {{table}} DROP COLUMN IF EXISTS {{fieldName}};

{{#if (eq type 'enum')}}
-- Odstr√°≈à enum typ
DROP TYPE IF EXISTS {{fieldName}}_enum CASCADE;
{{/if}}

-- Valid√°cia rollback
SELECT 
    '‚úÖ Rollback validation' as status,
    COUNT(*) as total_rows
FROM {{table}};

-- Inform√°cia o backup
SELECT 
    '‚ÑπÔ∏è Backup info' as status,
    'Data backed up in migration_backup_{{timestamp}}' as message;

COMMIT;

-- ‚úÖ Rollback {{fieldName}} √∫spe≈°ne dokonƒçen√Ω!
