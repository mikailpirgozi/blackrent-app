import { useExpenses } from '@/lib/react-query/hooks/useExpenses';
import { useAllProtocols } from '@/lib/react-query/hooks/useProtocols';
import { useRentals } from '@/lib/react-query/hooks/useRentals';
import { useVehicles } from '@/lib/react-query/hooks/useVehicles';
import {
/* Tailwind classes used for styling */
  AccountBalance as AccountBalanceIcon,
  Assessment as AssessmentIcon,
  Business as BusinessIcon,
  CalendarToday as CalendarIcon,
  DirectionsCar as CarIcon,
  CheckCircle as CheckCircleIcon,
  CreditCard as CreditCardIcon,
  Dashboard as DashboardIcon,
  Euro as EuroIcon,
  AttachMoney as MoneyIcon,
  Payment as PaymentIcon,
  Percent as PercentIcon,
  Person as PersonIcon,
  Refresh as RefreshIcon,
  ShowChart as ShowChartIcon,
  Speed as SpeedIcon,
  Star as StarIcon,
  AccessTime as TimeIcon,
  TrendingDown as TrendingDownIcon,
  TrendingUp as TrendingUpIcon,
  EmojiEvents as TrophyIcon,
  Warning as WarningIcon,
} from '@mui/icons-material';
import KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';
import { Alert,
  Avatar, Button,
  Card,
  CardContent,
  Chip,
  Divider,
  FormControl,
  Grid,
  InputLabel,
  LinearProgress,
  MenuItem,
  Select,
  Tab,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Tabs,
  Typography,
  useMediaQuery,
  useTheme, } from '@mui/material';
import {
  differenceInDays,
  endOfMonth,
  endOfYear,
  format,
  getDaysInMonth,
  isAfter,
  isBefore,
  startOfMonth,
  startOfYear,
  subMonths,
} from 'date-fns';
import { sk } from 'date-fns/locale';
import React, { useMemo, useState } from 'react';
import {
  Area,
  AreaChart,
  Bar,
  BarChart,
  CartesianGrid,
  Cell,
  Legend,
  Line,
  LineChart,
  Pie,
  PieChart,
  ResponsiveContainer,
  Tooltip,
  XAxis,
  YAxis,
} from 'recharts';
import { logger } from '../utils/smartLogger';
import StatisticsMobile from './statistics/StatisticsMobile';

// Type definitions
interface VehicleStatistic extends Record<string, unknown> {
  vehicle: {
    id: string;
    brand: string;
    model: string;
    licensePlate: string;
    company?: string;
  };
  totalRevenue: number;
  rentalCount: number;
  totalDaysRented: number;
  utilizationPercentage: number;
  avgRevenuePerRental: number;
}

interface CustomerStatistic extends Record<string, unknown> {
  customerName: string;
  customer?: Record<string, unknown>;
  totalRevenue: number;
  rentalCount: number;
  totalDaysRented: number;
  lastRentalDate: Date;
  avgRentalDuration: number;
}

interface EmployeeStatistic extends Record<string, unknown> {
  employeeName: string;
  handoverCount: number;
  returnCount: number;
  totalProtocols: number;
  handoverRevenue: number;
  returnRevenue: number;
  totalRevenue: number;
  uniqueRentals: number;
}

interface TabPanelProps {
  children?: React.ReactNode;
  index: number;
  value: number;
}

function TabPanel(props: TabPanelProps) {
  const { children, value, index, ...other } = props;
  return (
    <div
      role="tabpanel"
      hidden={value !== index}
      id={`stats-tabpanel-${index}`}
      aria-labelledby={`stats-tab-${index}`}
      {...other}
    >
      {value === index && <div className="p-6">{children}</div>}
    </div>
  );
}

const COLORS = [
  '#667eea',
  '#764ba2',
  '#f093fb',
  '#f5576c',
  '#4facfe',
  '#00f2fe',
];

const Statistics: React.FC = () => {
  // React Query hooks
  const { data: rentals = [] } = useRentals();
  const { data: expenses = [] } = useExpenses();
  const { data: protocols = [] } = useAllProtocols();
  const { data: vehicles = [] } = useVehicles();

  const theme = useTheme();
  const isMobile = useMediaQuery(theme.breakpoints.down('md'));

  // Loading state
  // const isLoading =
  //   rentalsLoading || expensesLoading || protocolsLoading || vehiclesLoading;

  const [selectedYear] = useState(new Date().getFullYear());
  const [selectedMonth] = useState(new Date().getMonth());
  const [tabValue, setTabValue] = useState(0);
  // const [expandedMonth, setExpandedMonth] = useState<string | null>(null);
  const [timeRange, setTimeRange] = useState<'month' | 'year' | 'all'>('month');

  // Nov√© state pre filtrovanie
  const [filterYear, setFilterYear] = useState(new Date().getFullYear());
  const [filterMonth, setFilterMonth] = useState(new Date().getMonth());

  // State pre pagination Top ≈°tatist√≠k
  const [showVehiclesByUtilization, setShowVehiclesByUtilization] =
    useState(10);
  const [showVehiclesByRevenue, setShowVehiclesByRevenue] = useState(10);
  const [showVehiclesByRentals, setShowVehiclesByRentals] = useState(10);
  const [showCustomersByRentals, setShowCustomersByRentals] = useState(10);
  const [showCustomersByRevenue, setShowCustomersByRevenue] = useState(10);
  const [showCustomersByDays, setShowCustomersByDays] = useState(10);

  // Re√°lne d√°ta z aplik√°cie s nov√Ωmi metrikami
  const stats = useMemo(() => {
    const currentDate = new Date();
    const currentMonth = currentDate.getMonth();
    const currentYear = currentDate.getFullYear();

    // Defin√≠cia filtrovacieho obdobia
    let filterStartDate: Date;
    let filterEndDate: Date;

    if (timeRange === 'month') {
      filterStartDate = startOfMonth(new Date(filterYear, filterMonth));
      filterEndDate = endOfMonth(new Date(filterYear, filterMonth));
    } else if (timeRange === 'year') {
      filterStartDate = startOfYear(new Date(filterYear, 0));
      filterEndDate = endOfYear(new Date(filterYear, 0));
    } else {
      // 'all'
      filterStartDate = new Date(2020, 0, 1); // Zaƒçiatok BlackRent
      filterEndDate = new Date();
    }

    logger.debug('Statistics filter period', {
      timeRange,
      filterYear,
      filterMonth,
      filterStartDate: format(filterStartDate, 'yyyy-MM-dd'),
      filterEndDate: format(filterEndDate, 'yyyy-MM-dd'),
    });

    // Filtrovan√© pren√°jmy pre vybran√© obdobie
    const filteredRentals = rentals.filter(rental => {
      const rentalDate = new Date(rental.startDate);
      return rentalDate >= filterStartDate && rentalDate <= filterEndDate;
    });

    // Filtrovan√© n√°klady pre vybran√© obdobie a iba Black Holding
    const filteredExpenses = expenses.filter(expense => {
      const expenseDate = new Date(expense.date);
      const isInPeriod =
        expenseDate >= filterStartDate && expenseDate <= filterEndDate;
      const isBlackHolding = expense.company
        ?.toLowerCase()
        .includes('black holding');
      return isInPeriod && isBlackHolding;
    });

    logger.performance('Statistics data processed', {
      rentals: filteredRentals.length,
      expenses: filteredExpenses.length,
      totalExpenseAmount: filteredExpenses.reduce(
        (sum, exp) => sum + exp.amount,
        0
      ),
      timeRange,
    });

    // NOV√â METRIKY
    // 1. Celkov√© tr≈æby za obdobie
    const totalRevenuePeriod = filteredRentals.reduce(
      (sum, rental) => sum + (rental.totalPrice || 0),
      0
    );

    // 2. N√°klady Black Holding za obdobie
    const blackHoldingExpenses = filteredExpenses.reduce(
      (sum, expense) => sum + expense.amount,
      0
    );

    // 3. Celkov√© prov√≠zie za obdobie
    const totalCommissionPeriod = filteredRentals.reduce(
      (sum, rental) => sum + (rental.commission || 0),
      0
    );

    // POKROƒåIL√â AUTO ≈†TATISTIKY - pou≈æ√≠vame vozidl√° s definovanou kateg√≥riou
    const filteredVehicles = vehicles.filter(
      vehicle => vehicle.category !== undefined
    );
    const vehicleStats = filteredVehicles
      .map(vehicle => {
        const vehicleRentals = filteredRentals.filter(
          rental => rental.vehicleId === vehicle.id
        );

        // Celkov√© pr√≠jmy z auta
        const totalRevenue = vehicleRentals.reduce(
          (sum, rental) => sum + (rental.totalPrice || 0),
          0
        );

        // Poƒçet pren√°jmov
        const rentalCount = vehicleRentals.length;

        // Celkov√© dni pren√°jmu
        const totalDaysRented = vehicleRentals.reduce((sum, rental) => {
          return (
            sum +
            differenceInDays(
              new Date(rental.endDate),
              new Date(rental.startDate)
            ) +
            1
          );
        }, 0);

        // V√Ωpoƒçet % vy≈•a≈æenosti
        let utilizationPercentage = 0;
        if (timeRange === 'month') {
          const daysInMonth = getDaysInMonth(new Date(filterYear, filterMonth));
          utilizationPercentage = (totalDaysRented / daysInMonth) * 100;
        } else if (timeRange === 'year') {
          const daysInYear = 365; // Zjednodu≈°ene
          utilizationPercentage = (totalDaysRented / daysInYear) * 100;
        } else {
          // Pre 'all' - vypoƒç√≠tame od zaƒçiatku BlackRent
          const daysSinceStart = differenceInDays(
            new Date(),
            new Date(2020, 0, 1)
          );
          utilizationPercentage = (totalDaysRented / daysSinceStart) * 100;
        }

        return {
          vehicle,
          totalRevenue,
          rentalCount,
          totalDaysRented,
          utilizationPercentage: Math.min(utilizationPercentage, 100), // Max 100%
          avgRevenuePerRental: rentalCount > 0 ? totalRevenue / rentalCount : 0,
        };
      })
      .filter(stat => stat.rentalCount > 0); // Iba aut√° s pren√°jmami

    // POKROƒåIL√â Z√ÅKAZN√çK ≈†TATISTIKY
    const customerStats = filteredRentals.reduce(
      (acc, rental) => {
        const customerId = rental.customerId || rental.customerName;
        if (!customerId) return acc;

        if (!acc[customerId]) {
          acc[customerId] = {
            customerName: rental.customerName,
            customer: rental.customer as Record<string, unknown> | undefined,
            totalRevenue: 0,
            rentalCount: 0,
            totalDaysRented: 0,
            lastRentalDate: new Date(rental.startDate),
            avgRentalDuration: 0,
          };
        }

        acc[customerId].totalRevenue += rental.totalPrice || 0;
        acc[customerId].rentalCount += 1;

        const rentalDays =
          differenceInDays(
            new Date(rental.endDate),
            new Date(rental.startDate)
          ) + 1;
        acc[customerId].totalDaysRented += rentalDays;

        // Aktualiz√°cia posledn√©ho pren√°jmu
        if (new Date(rental.startDate) > acc[customerId].lastRentalDate) {
          acc[customerId].lastRentalDate = new Date(rental.startDate);
        }

        return acc;
      },
      {} as Record<string, CustomerStatistic>
    );

    // V√Ωpoƒçet priemernej dƒ∫≈æky pren√°jmu pre ka≈æd√©ho z√°kazn√≠ka
    Object.values(customerStats).forEach(customer => {
      customer.avgRentalDuration =
        customer.rentalCount > 0
          ? customer.totalDaysRented / customer.rentalCount
          : 0;
    });

    const customerStatsArray = Object.values(customerStats);

    // TOP AUTO ≈†TATISTIKY
    const topVehicleByUtilization =
      vehicleStats.length > 0
        ? vehicleStats.reduce(
            (prev, current) =>
              prev.utilizationPercentage > current.utilizationPercentage
                ? prev
                : current,
            vehicleStats[0]
          )
        : null;

    const topVehicleByRevenue =
      vehicleStats.length > 0
        ? vehicleStats.reduce(
            (prev, current) =>
              prev.totalRevenue > current.totalRevenue ? prev : current,
            vehicleStats[0]
          )
        : null;

    const topVehicleByRentals =
      vehicleStats.length > 0
        ? vehicleStats.reduce(
            (prev, current) =>
              prev.rentalCount > current.rentalCount ? prev : current,
            vehicleStats[0]
          )
        : null;

    // TOP Z√ÅKAZN√çK ≈†TATISTIKY
    const topCustomerByRentals =
      customerStatsArray.length > 0
        ? customerStatsArray.reduce(
            (prev, current) =>
              prev.rentalCount > current.rentalCount ? prev : current,
            customerStatsArray[0]
          )
        : null;

    const topCustomerByRevenue =
      customerStatsArray.length > 0
        ? customerStatsArray.reduce(
            (prev, current) =>
              prev.totalRevenue > current.totalRevenue ? prev : current,
            customerStatsArray[0]
          )
        : null;

    const topCustomerByDays =
      customerStatsArray.length > 0
        ? customerStatsArray.reduce(
            (prev, current) =>
              prev.totalDaysRented > current.totalDaysRented ? prev : current,
            customerStatsArray[0]
          )
        : null;

    // Existuj√∫ce v√Ωpoƒçty (pre v≈°etky ƒçasy)
    const currentMonthRentals = rentals.filter(rental => {
      const rentalDate = new Date(rental.startDate);
      return (
        rentalDate.getMonth() === currentMonth &&
        rentalDate.getFullYear() === currentYear
      );
    });

    const currentYearRentals = rentals.filter(rental => {
      const rentalDate = new Date(rental.startDate);
      return rentalDate.getFullYear() === currentYear;
    });

    const selectedMonthRentals = rentals.filter(rental => {
      const rentalDate = new Date(rental.startDate);
      return (
        rentalDate.getMonth() === selectedMonth &&
        rentalDate.getFullYear() === selectedYear
      );
    });

    const selectedYearRentals = rentals.filter(rental => {
      const rentalDate = new Date(rental.startDate);
      return rentalDate.getFullYear() === selectedYear;
    });

    // Akt√≠vne pren√°jmy
    const activeRentals = rentals.filter(rental => {
      const now = new Date();
      const startDate = new Date(rental.startDate);
      const endDate = new Date(rental.endDate);
      return isAfter(now, startDate) && isBefore(now, endDate);
    });

    // Dne≈°n√© vr√°tenia
    const todayReturns = rentals.filter(rental => {
      const today = new Date();
      const endDate = new Date(rental.endDate);
      return format(today, 'yyyy-MM-dd') === format(endDate, 'yyyy-MM-dd');
    });

    // Zajtraj≈°ie vr√°tenia
    const tomorrowReturns = rentals.filter(rental => {
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      const endDate = new Date(rental.endDate);
      return format(tomorrow, 'yyyy-MM-dd') === format(endDate, 'yyyy-MM-dd');
    });

    // Nezaplaten√© pren√°jmy
    const unpaidRentals = rentals.filter(rental => !rental.paid);

    // V√Ωpoƒçet celkov√Ωch pr√≠jmov (v≈°etky ƒçasy)
    const totalRevenue = rentals.reduce(
      (sum, rental) => sum + (rental.totalPrice || 0),
      0
    );
    const totalCommission = rentals.reduce(
      (sum, rental) => sum + (rental.commission || 0),
      0
    );

    // V√Ωpoƒçet priemern√Ωch hodn√¥t
    const avgRentalPrice =
      rentals.length > 0 ? totalRevenue / rentals.length : 0;
    const avgRentalDuration =
      rentals.length > 0
        ? rentals.reduce((sum, rental) => {
            const days =
              differenceInDays(
                new Date(rental.endDate),
                new Date(rental.startDate)
              ) + 1;
            return sum + days;
          }, 0) / rentals.length
        : 0;

    // ≈†tatistiky podƒæa sp√¥sobu platby
    const paymentMethodStats = rentals.reduce(
      (acc, rental) => {
        const method = rental.paymentMethod || 'unknown';
        if (!acc[method]) {
          acc[method] = { count: 0, revenue: 0 };
        }
        acc[method].count++;
        acc[method].revenue += rental.totalPrice || 0;
        return acc;
      },
      {} as Record<string, { count: number; revenue: number }>
    );

    // ≈†tatistiky podƒæa firiem
    const companyStats = rentals.reduce(
      (acc, rental) => {
        const company = rental.vehicle?.company || 'Bez firmy';
        if (!acc[company]) {
          acc[company] = { count: 0, revenue: 0, commission: 0 };
        }
        acc[company].count++;
        acc[company].revenue += rental.totalPrice || 0;
        acc[company].commission += rental.commission || 0;
        return acc;
      },
      {} as Record<
        string,
        { count: number; revenue: number; commission: number }
      >
    );

    // Mesiaƒçn√© d√°ta pre graf
    const monthlyData = Array.from({ length: 12 }, (_, i) => {
      const month = subMonths(new Date(), 11 - i);
      const monthRentals = rentals.filter(rental => {
        const rentalDate = new Date(rental.startDate);
        return (
          rentalDate.getMonth() === month.getMonth() &&
          rentalDate.getFullYear() === month.getFullYear()
        );
      });

      return {
        month: format(month, 'MMM yyyy'),
        rentals: monthRentals.length,
        revenue: monthRentals.reduce(
          (sum, rental) => sum + (rental.totalPrice || 0),
          0
        ),
        commission: monthRentals.reduce(
          (sum, rental) => sum + (rental.commission || 0),
          0
        ),
      };
    });

    return {
      // Nov√© metriky
      totalRevenuePeriod,
      blackHoldingExpenses,
      totalCommissionPeriod,
      filteredRentals,
      filteredExpenses,

      // Pokroƒçil√© ≈°tatistiky
      vehicleStats,
      customerStatsArray,
      topVehicleByUtilization,
      topVehicleByRevenue,
      topVehicleByRentals,
      topCustomerByRentals,
      topCustomerByRevenue,
      topCustomerByDays,

      // Sortovan√© zoznamy pre Top 10+ - vytv√°rame k√≥pie aby sa nemutoval origin√°lny array
      vehiclesByUtilization: (() => {
        const sorted = [...vehicleStats].sort(
          (a, b) => b.utilizationPercentage - a.utilizationPercentage
        );
        logger.debug(
          'Vehicles by utilization (top 3)',
          sorted.slice(0, 3).map(v => ({
            vehicle: `${v.vehicle.brand} ${v.vehicle.model}`,
            utilization: v.utilizationPercentage.toFixed(1) + '%',
          }))
        );
        return sorted;
      })(),
      vehiclesByRevenue: (() => {
        const sorted = [...vehicleStats].sort(
          (a, b) => b.totalRevenue - a.totalRevenue
        );
        logger.debug(
          'Vehicles by revenue (top 3)',
          sorted.slice(0, 3).map(v => ({
            vehicle: `${v.vehicle.brand} ${v.vehicle.model}`,
            revenue: v.totalRevenue + '‚Ç¨',
          }))
        );
        return sorted;
      })(),
      vehiclesByRentals: (() => {
        const sorted = [...vehicleStats].sort(
          (a, b) => b.rentalCount - a.rentalCount
        );
        logger.debug(
          'Vehicles by rentals (top 3)',
          sorted.slice(0, 3).map(v => ({
            vehicle: `${v.vehicle.brand} ${v.vehicle.model}`,
            rentals: v.rentalCount + 'x',
          }))
        );
        return sorted;
      })(),
      customersByRentals: (() => {
        const sorted = [...customerStatsArray].sort(
          (a, b) => b.rentalCount - a.rentalCount
        );
        logger.debug(
          'Customers by rentals (top 3)',
          sorted.slice(0, 3).map(c => ({
            customer: c.customerName,
            rentals: c.rentalCount + 'x',
          }))
        );
        return sorted;
      })(),
      customersByRevenue: (() => {
        const sorted = [...customerStatsArray].sort(
          (a, b) => b.totalRevenue - a.totalRevenue
        );
        logger.debug(
          'Customers by revenue (top 3)',
          sorted.slice(0, 3).map(c => ({
            customer: c.customerName,
            revenue: c.totalRevenue + '‚Ç¨',
          }))
        );
        return sorted;
      })(),
      customersByDays: (() => {
        const sorted = [...customerStatsArray].sort(
          (a, b) => b.totalDaysRented - a.totalDaysRented
        );
        logger.debug(
          'Customers by days (top 3)',
          sorted.slice(0, 3).map(c => ({
            customer: c.customerName,
            days: c.totalDaysRented + ' dn√≠',
          }))
        );
        return sorted;
      })(),

      // Existuj√∫ce
      currentMonthRentals,
      currentYearRentals,
      selectedMonthRentals,
      selectedYearRentals,
      activeRentals,
      todayReturns,
      tomorrowReturns,
      unpaidRentals,
      totalRevenue,
      totalCommission,
      avgRentalPrice,
      avgRentalDuration,
      paymentMethodStats,
      companyStats,
      monthlyData,

      // üìä EMPLOYEE STATISTICS: ≈†tatistiky zamestnancov na z√°klade protokolov
      employeeStats: (() => {
        // Filtrovan√© protokoly pre vybran√© obdobie
        const filteredProtocols = (
          protocols as Array<{
            createdAt: string;
            type: string;
            rentalId: string;
            createdBy?: string;
            rentalData?: { totalPrice?: number };
          }>
        ).filter(
          (protocol: {
            createdAt: string;
            type: string;
            rentalId: string;
            createdBy?: string;
            rentalData?: { totalPrice?: number };
          }) => {
            const protocolDate = new Date(protocol.createdAt);
            return (
              protocolDate >= filterStartDate && protocolDate <= filterEndDate
            );
          }
        );

        // Zoskupenie protokolov podƒæa zamestnanca
        const employeeProtocolStats = filteredProtocols.reduce(
          (
            acc: Record<
              string,
              {
                employeeName: string;
                handoverCount: number;
                returnCount: number;
                totalProtocols: number;
                handoverRevenue: number;
                returnRevenue: number;
                totalRevenue: number;
                rentals: Set<string>;
              }
            >,
            protocol: {
              createdAt: string;
              type: string;
              rentalId: string;
              createdBy?: string;
              rentalData?: { totalPrice?: number };
            }
          ) => {
            const employeeName = protocol.createdBy || 'Nezn√°my';

            if (!acc[employeeName]) {
              acc[employeeName] = {
                employeeName,
                handoverCount: 0,
                returnCount: 0,
                totalProtocols: 0,
                handoverRevenue: 0,
                returnRevenue: 0,
                totalRevenue: 0,
                rentals: new Set<string>(), // Pre sledovanie unik√°tnych pren√°jmov
              };
            }

            // N√°jdi pren√°jom pre tento protokol (hƒæadaj vo v≈°etk√Ωch pren√°jmoch, nie len filtrovan√Ωch)
            const rental = rentals.find(r => r.id === protocol.rentalId);

            // Sk√∫s z√≠ska≈• cenu z r√¥znych zdrojov
            let rentalPrice = 0;
            if (rental?.totalPrice) {
              rentalPrice = rental.totalPrice;
            } else if (protocol.rentalData?.totalPrice) {
              rentalPrice = protocol.rentalData.totalPrice;
            }

            if (protocol.type === 'handover') {
              acc[employeeName].handoverCount++;
              acc[employeeName].handoverRevenue += rentalPrice;
            } else {
              acc[employeeName].returnCount++;
              acc[employeeName].returnRevenue += rentalPrice;
            }

            acc[employeeName].totalProtocols++;
            acc[employeeName].totalRevenue += rentalPrice;
            acc[employeeName].rentals.add(protocol.rentalId);

            return acc;
          },
          {} as Record<
            string,
            {
              employeeName: string;
              handoverCount: number;
              returnCount: number;
              totalProtocols: number;
              handoverRevenue: number;
              returnRevenue: number;
              totalRevenue: number;
              rentals: Set<string>;
            }
          >
        );

        // Konverzia na array a pridanie poƒçtu unik√°tnych pren√°jmov
        const employeeStatsArray = Object.values(employeeProtocolStats).map(
          (emp: {
            employeeName: string;
            handoverCount: number;
            returnCount: number;
            totalProtocols: number;
            handoverRevenue: number;
            returnRevenue: number;
            totalRevenue: number;
            rentals: Set<string>;
          }) => ({
            employeeName: emp.employeeName,
            handoverCount: emp.handoverCount,
            returnCount: emp.returnCount,
            totalProtocols: emp.totalProtocols,
            handoverRevenue: emp.handoverRevenue,
            returnRevenue: emp.returnRevenue,
            totalRevenue: emp.totalRevenue,
            uniqueRentals: emp.rentals.size,
          })
        );

        // Sortovanie podƒæa celkov√©ho poƒçtu protokolov
        const topEmployeesByProtocols = [...employeeStatsArray].sort(
          (a, b) => b.totalProtocols - a.totalProtocols
        );
        const topEmployeesByRevenue = [...employeeStatsArray].sort(
          (a, b) => b.totalRevenue - a.totalRevenue
        );
        const topEmployeesByHandovers = [...employeeStatsArray].sort(
          (a, b) => b.handoverCount - a.handoverCount
        );
        const topEmployeesByReturns = [...employeeStatsArray].sort(
          (a, b) => b.returnCount - a.returnCount
        );

        return {
          allEmployees: employeeStatsArray,
          topEmployeesByProtocols,
          topEmployeesByRevenue,
          topEmployeesByHandovers,
          topEmployeesByReturns,
          totalProtocols: filteredProtocols.length,
          totalHandovers: filteredProtocols.filter(
            (p: { type: string }) => p.type === 'handover'
          ).length,
          totalReturns: filteredProtocols.filter(
            (p: { type: string }) => p.type === 'return'
          ).length,
          activeEmployees: employeeStatsArray.length,
        };
      })(),
    };
  }, [
    rentals,
    expenses,
    protocols,
    vehicles,
    selectedYear,
    selectedMonth,
    timeRange,
    filterYear,
    filterMonth,
  ]);

  const handleTabChange = (event: React.SyntheticEvent, newValue: number) => {
    setTabValue(newValue);
  };

  // const toggleMonthExpansion = (monthKey: string) => {
  //   setExpandedMonth(expandedMonth === monthKey ? null : monthKey);
  // };

  // Custom Tooltip pre grafy
  const CustomTooltip = ({
    active,
    payload,
    label,
  }: {
    active?: boolean;
    payload?: Array<{ color: string; value: number; name: string }>;
    label?: string;
  }) => {
    if (active && payload && payload.length) {
      return (
        <Card className="p-4 shadow-md">
          <Typography variant="body2" fontWeight="bold" gutterBottom>
            {label}
          </Typography>
          {payload.map(
            (
              entry: { color: string; value: number; name: string },
              index: number
            ) => (
              <Typography key={index} variant="body2" color={entry.color}>
                {entry.name}: {entry.value.toLocaleString()} ‚Ç¨
              </Typography>
            )
          )}
        </Card>
      );
    }
    return null;
  };

  // Modernizovan√© ≈°tatistick√© karty
  const StatCard = ({
    title,
    value,
    subtitle,
    icon,
    gradient,
    trend,
  }: {
    title: string;
    value: string | number;
    subtitle?: string;
    icon: React.ReactNode;
    gradient: string;
    trend?: { value: number; isPositive: boolean };
  }) => (
    <Card
      sx={{
        height: '100%',
        background: gradient,
        color: 'white',
        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
        transition: 'all 0.2s ease',
        '&:hover': {
          boxShadow: '0 8px 24px rgba(0,0,0,0.2)',
          transform: 'translateY(-4px)',
        },
      }}
    >
      <CardContent>
        <div
          className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert mb: 2 */"
        >
          <div>
            <Typography
              variant="h6"
              className="/* TODO: Convert fontWeight: 600 */ /* TODO: Convert mb: 1 */ /* TODO: Convert opacity: 0.9 */"
            >
              {title.toUpperCase()}
            </Typography>
            <Typography variant="h4" className="/* TODO: Convert fontWeight: 700 */">
              {typeof value === 'number' ? value.toLocaleString() : value}
            </Typography>
            {subtitle && (
              <Typography variant="body2" className="/* TODO: Convert opacity: 0.8 */ /* TODO: Convert mt: 0.5 */">
                {subtitle}
              </Typography>
            )}
          </div>
          <div className="/* TODO: Convert opacity: 0.8 */">
            {React.cloneElement(icon as React.ReactElement, {
              sx: { fontSize: 40 },
            })}
          </div>
        </div>

        {trend && (
          <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-1 /* TODO: Convert mt: 1 */">
            {trend.isPositive ? (
              <TrendingUpIcon className="/* TODO: Convert fontSize: 16 */" />
            ) : (
              <TrendingDownIcon className="/* TODO: Convert fontSize: 16 */" />
            )}
            <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
              {trend.isPositive ? '+' : ''}
              {trend.value}%
            </Typography>
            <Typography variant="body2" className="/* TODO: Convert opacity: 0.8 */">
              vs. predch. obdobie
            </Typography>
          </div>
        )}
      </CardContent>
    </Card>
  );

  // Komponenta pre TOP ≈°tatistiky
  const TopStatCard = ({
    title,
    icon,
    data,
    primaryValue,
    secondaryValue,
    gradient,
    percentage,
  }: {
    title: string;
    icon: React.ReactNode;
    data: Record<string, unknown>;
    primaryValue: string;
    secondaryValue: string;
    gradient: string;
    percentage?: number;
  }) => (
    <Card
      sx={{
        height: '100%',
        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
        transition: 'all 0.2s ease',
        '&:hover': {
          boxShadow: '0 8px 24px rgba(0,0,0,0.15)',
          transform: 'translateY(-4px)',
        },
      }}
    >
      <CardContent>
        <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4 /* TODO: Convert mb: 2 */">
          <Avatar
            className="/* TODO: Convert bgcolor: transparent */ /* TODO: Convert background: gradient */ /* TODO: Convert width: 56 */ /* TODO: Convert height: 56 */"
          >
            {icon}
          </Avatar>
          <div className="/* TODO: Convert flex: 1 */">
            <Typography variant="h6" className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */">
              {title}
            </Typography>
            <Typography variant="body2" color="text.secondary">
              {data && typeof data === 'object'
                ? 'vehicle' in data &&
                  data.vehicle &&
                  typeof data.vehicle === 'object'
                  ? `${(data.vehicle as Record<string, unknown>).brand || ''} ${(data.vehicle as Record<string, unknown>).model || ''}`.trim() ||
                    'N/A'
                  : 'customerName' in data &&
                      typeof data.customerName === 'string'
                    ? data.customerName
                    : 'N/A'
                : 'N/A'}
            </Typography>
          </div>
          <TrophyIcon className="/* TODO: Convert color: #ffd700 */ /* TODO: Convert fontSize: 32 */" />
        </div>

        <div className="/* TODO: Convert mb: 2 */">
          <Typography
            variant="h4"
            className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */ /* TODO: Convert mb: 0.5 */"
          >
            {primaryValue}
          </Typography>
          <Typography variant="body2" color="text.secondary">
            {secondaryValue}
          </Typography>
        </div>

        {percentage !== undefined && (
          <div className="/* TODO: Convert mt: 2 */">
            <div
              className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert mb: 1 */"
            >
              <Typography variant="body2" color="text.secondary">
                Vy≈•a≈æenos≈•
              </Typography>
              <Typography
                variant="body2"
                className="/* TODO: Convert fontWeight: 600 */ /* TODO: Convert color: #667eea */"
              >
                {percentage.toFixed(1)}%
              </Typography>
            </div>
            <LinearProgress
              variant="determinate"
              value={Math.min(percentage, 100)}
              sx={{
                height: 8,
                borderRadius: 4,
                backgroundColor: '#e0e0e0',
                '& .MuiLinearProgress-bar': {
                  background: gradient,
                  borderRadius: 4,
                },
              }}
            />
          </div>
        )}
      </CardContent>
    </Card>
  );

  // Nov√Ω komponent pre Top 10+ zoznamy
  const TopListCard = ({
    title,
    icon,
    gradient,
    data,
    showCount,
    onLoadMore,
    renderItem,
    emptyMessage = '≈Ωiadne d√°ta',
  }: {
    title: string;
    icon: React.ReactNode;
    gradient: string;
    data: Record<string, unknown>[];
    showCount: number;
    onLoadMore: () => void;
    renderItem: (
      item: Record<string, unknown>,
      index: number
    ) => React.ReactNode;
    emptyMessage?: string;
  }) => (
    <Card
      sx={{
        height: 'fit-content',
        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
        transition: 'all 0.2s ease',
        '&:hover': {
          boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
        },
      }}
    >
      <CardContent>
        <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4 /* TODO: Convert mb: 3 */">
          <Avatar
            className="/* TODO: Convert bgcolor: transparent */ /* TODO: Convert background: gradient */ /* TODO: Convert width: 48 */ /* TODO: Convert height: 48 */"
          >
            {icon}
          </Avatar>
          <div className="/* TODO: Convert flex: 1 */">
            <Typography variant="h6" className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */">
              {title}
            </Typography>
            <Typography variant="body2" color="text.secondary">
              Top {Math.min(showCount, data.length)} z {data.length}
            </Typography>
          </div>
          <TrophyIcon className="/* TODO: Convert color: #ffd700 */ /* TODO: Convert fontSize: 28 */" />
        </div>

        {data.length === 0 ? (
          <div className="/* TODO: Convert textAlign: center */ /* TODO: Convert py: 4 */">
            <Typography variant="body1" color="text.secondary">
              {emptyMessage}
            </Typography>
          </div>
        ) : (
          <>
            <div className="/* TODO: Convert display: flex */ /* TODO: Convert flexDirection: column */ gap-3">
              {data
                .slice(0, showCount)
                .map((item, index) => renderItem(item, index))}
            </div>

            {showCount < data.length && (
              <div className="/* TODO: Convert mt: 3 */ /* TODO: Convert textAlign: center */">
                <Button
                  variant="outlined"
                  onClick={onLoadMore}
                  startIcon={<KeyboardArrowDownIcon />}
                  sx={{
                    borderColor: '#667eea',
                    color: '#667eea',
                    '&:hover': {
                      borderColor: '#5a6fd8',
                      backgroundColor: 'rgba(102, 126, 234, 0.04)',
                    },
                  }}
                >
                  Zobrazi≈• ƒèal≈°√≠ch {Math.min(10, data.length - showCount)}
                </Button>
              </div>
            )}
          </>
        )}
      </CardContent>
    </Card>
  );

  // Pomocn√° funkcia pre form√°tovanie obdobia
  const formatPeriod = () => {
    if (timeRange === 'month') {
      return format(new Date(filterYear, filterMonth), 'MMMM yyyy', {
        locale: sk,
      });
    } else if (timeRange === 'year') {
      return `${filterYear}`;
    } else {
      return 'Cel√° doba BlackRent';
    }
  };

  // Mobile view
  if (isMobile) {
    return (
      <StatisticsMobile
        stats={stats}
        timeRange={timeRange}
        onTimeRangeChange={setTimeRange}
        filterYear={filterYear}
        filterMonth={filterMonth}
        onFilterYearChange={setFilterYear}
        onFilterMonthChange={setFilterMonth}
        onRefresh={() => {
          // Force re-computation of stats
          window.location.reload();
        }}
        isLoading={false}
      />
    );
  }

  // Desktop view
  return (
    <div sx={{ p: { xs: 2, md: 3 } }}>
      {/* Modern Header */}
      <Card className="/* TODO: Convert mb: 3 */ /* TODO: Convert boxShadow: 0 4px 12px rgba(0 */">
        <CardContent
          className="/* TODO: Convert background: linear-gradient(135deg */ /* TODO: Convert color: white */ /* TODO: Convert position: relative */"
        >
          <div
            className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */"
          >
            <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4">
              <DashboardIcon className="/* TODO: Convert fontSize: 32 */" />
              <div>
                <Typography variant="h4" className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 0.5 */">
                  ≈†tatistiky & Dashboard
                </Typography>
                <Typography variant="body1" className="/* TODO: Convert opacity: 0.9 */">
                  Prehƒæad v√Ωkonnosti a obchodn√Ωch trendov
                </Typography>
              </div>
            </div>

            <div className="/* TODO: Convert display: flex */ gap-2 /* TODO: Convert alignItems: center */">
              <FormControl size="small" className="/* TODO: Convert minWidth: 120 */">
                <InputLabel
                  sx={{ color: 'white', '&.Mui-focused': { color: 'white' } }}
                >
                  Obdobie
                </InputLabel>
                <Select
                  value={timeRange}
                  onChange={e =>
                    setTimeRange(e.target.value as 'month' | 'year' | 'all')
                  }
                  label="Obdobie"
                  sx={{
                    color: 'white',
                    '.MuiOutlinedInput-notchedOutline': {
                      borderColor: 'rgba(255,255,255,0.3)',
                    },
                    '&:hover .MuiOutlinedInput-notchedOutline': {
                      borderColor: 'rgba(255,255,255,0.5)',
                    },
                    '&.Mui-focused .MuiOutlinedInput-notchedOutline': {
                      borderColor: 'white',
                    },
                    '.MuiSvgIcon-root': {
                      color: 'white',
                    },
                  }}
                >
                  <MenuItem value="month">Mesiac</MenuItem>
                  <MenuItem value="year">Rok</MenuItem>
                  <MenuItem value="all">Cel√° doba</MenuItem>
                </Select>
              </FormControl>

              {timeRange === 'month' && (
                <FormControl size="small" className="/* TODO: Convert minWidth: 140 */">
                  <InputLabel
                    sx={{ color: 'white', '&.Mui-focused': { color: 'white' } }}
                  >
                    Mesiac
                  </InputLabel>
                  <Select
                    value={filterMonth}
                    onChange={e => setFilterMonth(e.target.value as number)}
                    label="Mesiac"
                    sx={{
                      color: 'white',
                      '.MuiOutlinedInput-notchedOutline': {
                        borderColor: 'rgba(255,255,255,0.3)',
                      },
                      '&:hover .MuiOutlinedInput-notchedOutline': {
                        borderColor: 'rgba(255,255,255,0.5)',
                      },
                      '&.Mui-focused .MuiOutlinedInput-notchedOutline': {
                        borderColor: 'white',
                      },
                      '.MuiSvgIcon-root': {
                        color: 'white',
                      },
                    }}
                  >
                    {Array.from({ length: 12 }, (_, i) => (
                      <MenuItem key={i} value={i}>
                        {format(new Date(2023, i), 'MMMM', { locale: sk })}
                      </MenuItem>
                    ))}
                  </Select>
                </FormControl>
              )}

              {(timeRange === 'month' || timeRange === 'year') && (
                <FormControl size="small" className="/* TODO: Convert minWidth: 100 */">
                  <InputLabel
                    sx={{ color: 'white', '&.Mui-focused': { color: 'white' } }}
                  >
                    Rok
                  </InputLabel>
                  <Select
                    value={filterYear}
                    onChange={e => setFilterYear(e.target.value as number)}
                    label="Rok"
                    sx={{
                      color: 'white',
                      '.MuiOutlinedInput-notchedOutline': {
                        borderColor: 'rgba(255,255,255,0.3)',
                      },
                      '&:hover .MuiOutlinedInput-notchedOutline': {
                        borderColor: 'rgba(255,255,255,0.5)',
                      },
                      '&.Mui-focused .MuiOutlinedInput-notchedOutline': {
                        borderColor: 'white',
                      },
                      '.MuiSvgIcon-root': {
                        color: 'white',
                      },
                    }}
                  >
                    {Array.from({ length: 5 }, (_, i) => {
                      const year = new Date().getFullYear() - 2 + i;
                      return (
                        <MenuItem key={year} value={year}>
                          {year}
                        </MenuItem>
                      );
                    })}
                  </Select>
                </FormControl>
              )}

              <Button
                variant="contained"
                startIcon={<RefreshIcon />}
                size="small"
                sx={{
                  backgroundColor: 'rgba(255,255,255,0.2)',
                  backdropFilter: 'blur(10px)',
                  border: '1px solid rgba(255,255,255,0.3)',
                  '&:hover': {
                    backgroundColor: 'rgba(255,255,255,0.3)',
                  },
                }}
              >
                Obnovi≈•
              </Button>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Info karta s vybran√Ωm obdob√≠m */}
      <Alert severity="info" className="/* TODO: Convert mb: 3 */">
        <Typography variant="body1" className="/* TODO: Convert fontWeight: 600 */">
          üìä Zobrazuj√∫ sa d√°ta za obdobie: <strong>{formatPeriod()}</strong>
        </Typography>
        <Typography variant="body2">
          Pren√°jmy: {stats.filteredRentals.length} ‚Ä¢ N√°klady Black Holding:{' '}
          {stats.filteredExpenses.length}
        </Typography>
      </Alert>

      {/* NOV√â ≈°tatistick√© karty pre vybran√© obdobie */}
      <Grid container spacing={3} className="/* TODO: Convert mb: 3 */">
        <Grid item xs={12} sm={6} md={4}>
          <StatCard
            title="Tr≈æby za obdobie"
            value={`${stats.totalRevenuePeriod.toLocaleString()} ‚Ç¨`}
            subtitle={formatPeriod()}
            icon={<CreditCardIcon />}
            gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
          />
        </Grid>

        <Grid item xs={12} sm={6} md={4}>
          <StatCard
            title="N√°klady Black Holding"
            value={`${stats.blackHoldingExpenses.toLocaleString()} ‚Ç¨`}
            subtitle={formatPeriod()}
            icon={<AccountBalanceIcon />}
            gradient="linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)"
          />
        </Grid>

        <Grid item xs={12} sm={6} md={4}>
          <StatCard
            title="Prov√≠zie za obdobie"
            value={`${stats.totalCommissionPeriod.toLocaleString()} ‚Ç¨`}
            subtitle={formatPeriod()}
            icon={<PercentIcon />}
            gradient="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"
          />
        </Grid>
      </Grid>

      {/* Existuj√∫ce kƒæ√∫ƒçov√© metriky */}
      <Typography
        variant="h5"
        className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 2 */ /* TODO: Convert color: #667eea */"
      >
        V≈°eobecn√© ≈°tatistiky
      </Typography>
      <Grid container spacing={3} className="/* TODO: Convert mb: 3 */">
        <Grid item xs={12} sm={6} md={3}>
          <StatCard
            title="Celkov√© pr√≠jmy"
            value={`${stats.totalRevenue.toLocaleString()} ‚Ç¨`}
            subtitle="V≈°etky ƒçasy"
            icon={<EuroIcon />}
            gradient="linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"
            trend={{ value: 12.5, isPositive: true }}
          />
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <StatCard
            title="Akt√≠vne pren√°jmy"
            value={stats.activeRentals.length}
            subtitle="Moment√°lne akt√≠vne"
            icon={<CarIcon />}
            gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
          />
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <StatCard
            title="Dne≈°n√© vr√°tenia"
            value={stats.todayReturns.length}
            subtitle="Vr√°tenia dnes"
            icon={<CalendarIcon />}
            gradient="linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%)"
          />
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <StatCard
            title="Nezaplaten√©"
            value={stats.unpaidRentals.length}
            subtitle="ƒåakaj√∫ na platbu"
            icon={<WarningIcon />}
            gradient="linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)"
          />
        </Grid>
      </Grid>

      {/* Modernizovan√© Tabs */}
      <Card className="/* TODO: Convert mb: 3 */ /* TODO: Convert boxShadow: 0 2px 8px rgba(0 */">
        <div
          className="/* TODO: Convert borderBottom: 1 */ /* TODO: Convert borderColor: divider */ /* TODO: Convert background: linear-gradient(90deg */"
        >
          <Tabs
            value={tabValue}
            onChange={handleTabChange}
            aria-label="statistics tabs"
            sx={{
              '& .MuiTab-root': {
                textTransform: 'none',
                fontWeight: 600,
                fontSize: '1rem',
                minHeight: 64,
                '&.Mui-selected': {
                  color: '#667eea',
                },
              },
              '& .MuiTabs-indicator': {
                backgroundColor: '#667eea',
                height: 3,
              },
            }}
          >
            <Tab
              label={
                <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2">
                  <AssessmentIcon />
                  Prehƒæad
                </div>
              }
            />
            <Tab
              label={
                <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2">
                  <ShowChartIcon />
                  Grafy
                </div>
              }
            />
            <Tab
              label={
                <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2">
                  <BusinessIcon />
                  Firmy
                </div>
              }
            />
            <Tab
              label={
                <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2">
                  <PaymentIcon />
                  Platby
                </div>
              }
            />
            <Tab
              label={
                <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2">
                  <TrophyIcon />
                  Top ≈°tatistiky
                </div>
              }
            />
            <Tab
              label={
                <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2">
                  <PersonIcon />
                  Zamestnanci
                </div>
              }
            />
          </Tabs>
        </div>

        {/* Tab 1: Prehƒæad */}
        <TabPanel value={tabValue} index={0}>
          <Grid container spacing={3}>
            {/* Mesiaƒçn√Ω trend */}
            <Grid item xs={12} lg={8}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    Mesiaƒçn√Ω trend pr√≠jmov
                  </Typography>
                  <ResponsiveContainer width="100%" height={300}>
                    <AreaChart data={stats.monthlyData}>
                      <CartesianGrid strokeDasharray="3 3" />
                      <XAxis dataKey="month" />
                      <YAxis />
                      <Tooltip content={<CustomTooltip />} />
                      <Area
                        type="monotone"
                        dataKey="revenue"
                        stroke="#667eea"
                        fill="url(#colorRevenue)"
                        strokeWidth={3}
                        name="Pr√≠jmy"
                      />
                      <defs>
                        <linearGradient
                          id="colorRevenue"
                          x1="0"
                          y1="0"
                          x2="0"
                          y2="1"
                        >
                          <stop
                            offset="5%"
                            stopColor="#667eea"
                            stopOpacity={0.8}
                          />
                          <stop
                            offset="95%"
                            stopColor="#667eea"
                            stopOpacity={0.1}
                          />
                        </linearGradient>
                      </defs>
                    </AreaChart>
                  </ResponsiveContainer>
                </CardContent>
              </Card>
            </Grid>

            {/* R√Ωchle ≈°tatistiky */}
            <Grid item xs={12} lg={4}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    R√Ωchle ≈°tatistiky
                  </Typography>
                  <div
                    className="/* TODO: Convert display: flex */ /* TODO: Convert flexDirection: column */ gap-4"
                  >
                    <div
                      className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */ p-4 rounded /* TODO: Convert backgroundColor: #f8f9fa */"
                    >
                      <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
                        Priemern√° cena
                      </Typography>
                      <Typography
                        variant="h6"
                        fontWeight="bold"
                        className="/* TODO: Convert color: #11998e */"
                      >
                        {stats.avgRentalPrice.toFixed(2)} ‚Ç¨
                      </Typography>
                    </div>
                    <Divider />
                    <div
                      className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */ p-4 rounded /* TODO: Convert backgroundColor: #f8f9fa */"
                    >
                      <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
                        Priemern√° dƒ∫≈æka
                      </Typography>
                      <Typography
                        variant="h6"
                        fontWeight="bold"
                        className="/* TODO: Convert color: #667eea */"
                      >
                        {stats.avgRentalDuration.toFixed(1)} dn√≠
                      </Typography>
                    </div>
                    <Divider />
                    <div
                      className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */ p-4 rounded /* TODO: Convert backgroundColor: #f8f9fa */"
                    >
                      <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
                        Celkov√° prov√≠zia
                      </Typography>
                      <Typography
                        variant="h6"
                        fontWeight="bold"
                        color="warning.main"
                      >
                        {stats.totalCommission.toLocaleString()} ‚Ç¨
                      </Typography>
                    </div>
                    <Divider />
                    <div
                      className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */ p-4 rounded /* TODO: Convert backgroundColor: #f8f9fa */"
                    >
                      <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
                        Zajtraj≈°ie vr√°tenia
                      </Typography>
                      <Typography
                        variant="h6"
                        fontWeight="bold"
                        color="info.main"
                      >
                        {stats.tomorrowReturns.length}
                      </Typography>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </Grid>

            {/* Top firmy */}
            <Grid item xs={12}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    Top firmy podƒæa pr√≠jmov
                  </Typography>
                  <TableContainer>
                    <Table>
                      <TableHead>
                        <TableRow className="/* TODO: Convert backgroundColor: #f8f9fa */">
                          <TableCell className="/* TODO: Convert fontWeight: 700 */">Firma</TableCell>
                          <TableCell align="right" className="/* TODO: Convert fontWeight: 700 */">
                            Poƒçet pren√°jmov
                          </TableCell>
                          <TableCell align="right" className="/* TODO: Convert fontWeight: 700 */">
                            Pr√≠jmy
                          </TableCell>
                          <TableCell align="right" className="/* TODO: Convert fontWeight: 700 */">
                            Prov√≠zia
                          </TableCell>
                        </TableRow>
                      </TableHead>
                      <TableBody>
                        {Object.entries(stats.companyStats)
                          .sort(([, a], [, b]) => b.revenue - a.revenue)
                          .slice(0, 5)
                          .map(([company, data]) => (
                            <TableRow
                              key={company}
                              sx={{
                                '&:hover': {
                                  backgroundColor: '#f8f9fa',
                                },
                                transition: 'background-color 0.2s ease',
                              }}
                            >
                              <TableCell>
                                <div
                                  className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
                                >
                                  <Avatar
                                    className="/* TODO: Convert width: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert bgcolor: #667eea */"
                                  >
                                    <PersonIcon fontSize="small" />
                                  </Avatar>
                                  <Typography
                                    variant="body2"
                                    fontWeight="medium"
                                  >
                                    {company}
                                  </Typography>
                                </div>
                              </TableCell>
                              <TableCell align="right">
                                <Chip
                                  label={data.count}
                                  size="small"
                                  className="/* TODO: Convert backgroundColor: #667eea */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 600 */"
                                />
                              </TableCell>
                              <TableCell align="right">
                                <Typography
                                  variant="body2"
                                  fontWeight="bold"
                                  className="/* TODO: Convert color: #11998e */"
                                >
                                  {data.revenue.toLocaleString()} ‚Ç¨
                                </Typography>
                              </TableCell>
                              <TableCell align="right">
                                <Typography
                                  variant="body2"
                                  color="warning.main"
                                  fontWeight="bold"
                                >
                                  {data.commission.toLocaleString()} ‚Ç¨
                                </Typography>
                              </TableCell>
                            </TableRow>
                          ))}
                      </TableBody>
                    </Table>
                  </TableContainer>
                </CardContent>
              </Card>
            </Grid>
          </Grid>
        </TabPanel>

        {/* Tab 2: Grafy */}
        <TabPanel value={tabValue} index={1}>
          <Grid container spacing={3}>
            {/* Stƒ∫pcov√Ω graf - mesiaƒçn√© pren√°jmy */}
            <Grid item xs={12} lg={6}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    Poƒçet pren√°jmov podƒæa mesiacov
                  </Typography>
                  <ResponsiveContainer width="100%" height={300}>
                    <BarChart data={stats.monthlyData}>
                      <CartesianGrid strokeDasharray="3 3" />
                      <XAxis dataKey="month" />
                      <YAxis />
                      <Tooltip />
                      <Bar
                        dataKey="rentals"
                        fill="#667eea"
                        name="Pren√°jmy"
                        radius={[4, 4, 0, 0]}
                      />
                    </BarChart>
                  </ResponsiveContainer>
                </CardContent>
              </Card>
            </Grid>

            {/* Kol√°ƒçov√Ω graf - sp√¥soby platby */}
            <Grid item xs={12} lg={6}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    Rozdelenie podƒæa sp√¥sobu platby
                  </Typography>
                  <ResponsiveContainer width="100%" height={300}>
                    <PieChart>
                      <Pie
                        data={Object.entries(stats.paymentMethodStats).map(
                          ([method, data]) => ({
                            name: method,
                            value: data.count,
                          })
                        )}
                        cx="50%"
                        cy="50%"
                        labelLine={false}
                        label={({ name, percent }) =>
                          `${name} ${((percent || 0) * 100).toFixed(0)}%`
                        }
                        outerRadius={80}
                        fill="#667eea"
                        dataKey="value"
                      >
                        {Object.entries(stats.paymentMethodStats).map(
                          (entry, index) => (
                            <Cell
                              key={`cell-${index}`}
                              fill={COLORS[index % COLORS.length]}
                            />
                          )
                        )}
                      </Pie>
                      <Tooltip />
                    </PieChart>
                  </ResponsiveContainer>
                </CardContent>
              </Card>
            </Grid>

            {/* L√≠nov√Ω graf - trend pr√≠jmov vs prov√≠zi√≠ */}
            <Grid item xs={12}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    Trend pr√≠jmov vs prov√≠zi√≠
                  </Typography>
                  <ResponsiveContainer width="100%" height={400}>
                    <LineChart data={stats.monthlyData}>
                      <CartesianGrid strokeDasharray="3 3" />
                      <XAxis dataKey="month" />
                      <YAxis />
                      <Tooltip content={<CustomTooltip />} />
                      <Legend />
                      <Line
                        type="monotone"
                        dataKey="revenue"
                        stroke="#667eea"
                        strokeWidth={3}
                        name="Pr√≠jmy"
                        dot={{ fill: '#667eea', strokeWidth: 2, r: 6 }}
                      />
                      <Line
                        type="monotone"
                        dataKey="commission"
                        stroke="#11998e"
                        strokeWidth={3}
                        name="Prov√≠zie"
                        dot={{ fill: '#11998e', strokeWidth: 2, r: 6 }}
                      />
                    </LineChart>
                  </ResponsiveContainer>
                </CardContent>
              </Card>
            </Grid>
          </Grid>
        </TabPanel>

        {/* Tab 3: Firmy */}
        <TabPanel value={tabValue} index={2}>
          <Grid container spacing={3}>
            {Object.entries(stats.companyStats)
              .sort(([, a], [, b]) => b.revenue - a.revenue)
              .map(([company, data]) => (
                <Grid item xs={12} md={6} lg={4} key={company}>
                  <Card
                    sx={{
                      boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                      transition: 'all 0.2s ease',
                      '&:hover': {
                        boxShadow: '0 8px 24px rgba(0,0,0,0.15)',
                        transform: 'translateY(-4px)',
                      },
                    }}
                  >
                    <CardContent>
                      <div
                        className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4 /* TODO: Convert mb: 2 */"
                      >
                        <Avatar className="/* TODO: Convert bgcolor: #667eea */">
                          <PersonIcon />
                        </Avatar>
                        <div>
                          <Typography variant="h6" fontWeight="bold">
                            {company}
                          </Typography>
                          <Typography variant="body2" color="text.secondary">
                            {data.count} pren√°jmov
                          </Typography>
                        </div>
                      </div>

                      <div
                        className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert mb: 1 */ p-3 rounded /* TODO: Convert backgroundColor: #f8f9fa */"
                      >
                        <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
                          Pr√≠jmy:
                        </Typography>
                        <Typography
                          variant="body2"
                          fontWeight="bold"
                          className="/* TODO: Convert color: #11998e */"
                        >
                          {data.revenue.toLocaleString()} ‚Ç¨
                        </Typography>
                      </div>

                      <div
                        className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ p-3 rounded /* TODO: Convert backgroundColor: #fff3e0 */"
                      >
                        <Typography variant="body2" className="/* TODO: Convert fontWeight: 600 */">
                          Prov√≠zia:
                        </Typography>
                        <Typography
                          variant="body2"
                          color="warning.main"
                          fontWeight="bold"
                        >
                          {data.commission.toLocaleString()} ‚Ç¨
                        </Typography>
                      </div>
                    </CardContent>
                  </Card>
                </Grid>
              ))}
          </Grid>
        </TabPanel>

        {/* Tab 4: Platby */}
        <TabPanel value={tabValue} index={3}>
          <Grid container spacing={3}>
            <Grid item xs={12} lg={8}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    ≈†tatistiky platieb
                  </Typography>
                  <TableContainer>
                    <Table>
                      <TableHead>
                        <TableRow className="/* TODO: Convert backgroundColor: #f8f9fa */">
                          <TableCell className="/* TODO: Convert fontWeight: 700 */">
                            Sp√¥sob platby
                          </TableCell>
                          <TableCell align="right" className="/* TODO: Convert fontWeight: 700 */">
                            Poƒçet
                          </TableCell>
                          <TableCell align="right" className="/* TODO: Convert fontWeight: 700 */">
                            Pr√≠jmy
                          </TableCell>
                          <TableCell align="right" className="/* TODO: Convert fontWeight: 700 */">
                            Podiel
                          </TableCell>
                        </TableRow>
                      </TableHead>
                      <TableBody>
                        {Object.entries(stats.paymentMethodStats)
                          .sort(([, a], [, b]) => b.revenue - a.revenue)
                          .map(([method, data]) => {
                            const percentage =
                              (data.revenue / stats.totalRevenue) * 100;
                            return (
                              <TableRow
                                key={method}
                                sx={{
                                  '&:hover': {
                                    backgroundColor: '#f8f9fa',
                                  },
                                  transition: 'background-color 0.2s ease',
                                }}
                              >
                                <TableCell>
                                  <div
                                    className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
                                  >
                                    <Chip
                                      label={method}
                                      size="small"
                                      className="/* TODO: Convert backgroundColor: #667eea */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 600 */"
                                    />
                                  </div>
                                </TableCell>
                                <TableCell align="right">
                                  <Typography variant="body2" fontWeight="bold">
                                    {data.count}
                                  </Typography>
                                </TableCell>
                                <TableCell align="right">
                                  <Typography
                                    variant="body2"
                                    fontWeight="bold"
                                    className="/* TODO: Convert color: #11998e */"
                                  >
                                    {data.revenue.toLocaleString()} ‚Ç¨
                                  </Typography>
                                </TableCell>
                                <TableCell align="right">
                                  <Typography
                                    variant="body2"
                                    color="text.secondary"
                                    fontWeight="bold"
                                  >
                                    {percentage.toFixed(1)}%
                                  </Typography>
                                </TableCell>
                              </TableRow>
                            );
                          })}
                      </TableBody>
                    </Table>
                  </TableContainer>
                </CardContent>
              </Card>
            </Grid>

            <Grid item xs={12} lg={4}>
              <Card
                sx={{
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  '&:hover': {
                    boxShadow: '0 4px 16px rgba(0,0,0,0.15)',
                  },
                }}
              >
                <CardContent>
                  <Typography
                    variant="h6"
                    gutterBottom
                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                  >
                    Nezaplaten√© pren√°jmy
                  </Typography>
                  {stats.unpaidRentals.length === 0 ? (
                    <div className="/* TODO: Convert textAlign: center */ /* TODO: Convert py: 4 */">
                      <CheckCircleIcon
                        className="/* TODO: Convert fontSize: 48 */ /* TODO: Convert color: success.main */ /* TODO: Convert mb: 2 */"
                      />
                      <Typography
                        variant="body1"
                        color="success.main"
                        gutterBottom
                        fontWeight="bold"
                      >
                        V≈°etky pren√°jmy s√∫ zaplaten√©!
                      </Typography>
                    </div>
                  ) : (
                    <div
                      className="/* TODO: Convert display: flex */ /* TODO: Convert flexDirection: column */ gap-4"
                    >
                      {stats.unpaidRentals.slice(0, 5).map(rental => (
                        <div
                          key={rental.id}
                          sx={{
                            p: 2,
                            border: '1px solid',
                            borderColor: 'divider',
                            borderRadius: 2,
                            backgroundColor: '#fff3e0',
                            transition: 'all 0.2s ease',
                            '&:hover': {
                              boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                              transform: 'translateY(-2px)',
                            },
                          }}
                        >
                          <Typography variant="body2" fontWeight="bold">
                            {rental.customerName}
                          </Typography>
                          <Typography variant="caption" color="text.secondary">
                            {rental.vehicle?.brand} {rental.vehicle?.model}
                          </Typography>
                          <Typography
                            variant="body2"
                            color="error.main"
                            fontWeight="bold"
                          >
                            {rental.totalPrice?.toLocaleString()} ‚Ç¨
                          </Typography>
                        </div>
                      ))}
                      {stats.unpaidRentals.length > 5 && (
                        <Typography
                          variant="body2"
                          color="text.secondary"
                          textAlign="center"
                          fontWeight="bold"
                        >
                          + {stats.unpaidRentals.length - 5} ƒèal≈°√≠ch
                        </Typography>
                      )}
                    </div>
                  )}
                </CardContent>
              </Card>
            </Grid>
          </Grid>
        </TabPanel>

        {/* Tab 5: NOV√ù - Top ≈°tatistiky */}
        <TabPanel value={tabValue} index={4}>
          <Grid container spacing={3}>
            {/* √övodn√Ω prehƒæad */}
            <Grid item xs={12}>
              <Card
                className="/* TODO: Convert mb: 3 */ /* TODO: Convert background:
                    linear-gradient(135deg */ /* TODO: Convert color: white */ /* TODO: Convert boxShadow: 0 4px 12px rgba(0 */"
              >
                <CardContent>
                  <div className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4">
                    <TrophyIcon className="/* TODO: Convert fontSize: 40 */" />
                    <div>
                      <Typography
                        variant="h4"
                        className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 0.5 */"
                      >
                        TOP ≈†tatistiky
                      </Typography>
                      <Typography variant="body1" className="/* TODO: Convert opacity: 0.9 */">
                        Najlep≈°ie v√Ωkony za obdobie: {formatPeriod()}
                      </Typography>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </Grid>

            {/* üèÜ NAJLEP≈†IE V√ùKONY - Prehƒæadov√© karty */}
            <Grid item xs={12}>
              <Typography
                variant="h5"
                className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 3 */ /* TODO: Convert color: #667eea */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
              >
                <StarIcon />
                üèÜ Najlep≈°ie v√Ωkony
              </Typography>
            </Grid>

            {/* Top v√Ωkony v 3 kart√°ch */}
            <Grid item xs={12} md={4}>
              <TopStatCard
                title="Najvy≈•a≈æenej≈°ie auto"
                icon={<SpeedIcon />}
                data={
                  (stats.topVehicleByUtilization as Record<string, unknown>) ||
                  {}
                }
                primaryValue={
                  stats.topVehicleByUtilization
                    ? `${stats.topVehicleByUtilization.utilizationPercentage.toFixed(1)}%`
                    : 'N/A'
                }
                secondaryValue={
                  stats.topVehicleByUtilization
                    ? `${stats.topVehicleByUtilization.totalDaysRented} dn√≠ pren√°jmu`
                    : ''
                }
                gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
                percentage={
                  stats.topVehicleByUtilization?.utilizationPercentage
                }
              />
            </Grid>

            <Grid item xs={12} md={4}>
              <TopStatCard
                title="Najv√Ωnosnej≈°ie auto"
                icon={<EuroIcon />}
                data={
                  (stats.topVehicleByRevenue as Record<string, unknown>) || {}
                }
                primaryValue={
                  stats.topVehicleByRevenue
                    ? `${stats.topVehicleByRevenue.totalRevenue.toLocaleString()} ‚Ç¨`
                    : 'N/A'
                }
                secondaryValue={
                  stats.topVehicleByRevenue
                    ? `${stats.topVehicleByRevenue.rentalCount} pren√°jmov`
                    : ''
                }
                gradient="linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"
              />
            </Grid>

            <Grid item xs={12} md={4}>
              <TopStatCard
                title="Najakt√≠vnej≈°√≠ z√°kazn√≠k"
                icon={<PersonIcon />}
                data={
                  (stats.topCustomerByRentals as Record<string, unknown>) || {}
                }
                primaryValue={
                  stats.topCustomerByRentals
                    ? `${stats.topCustomerByRentals.rentalCount}x`
                    : 'N/A'
                }
                secondaryValue={
                  stats.topCustomerByRentals
                    ? `${stats.topCustomerByRentals.totalRevenue.toLocaleString()} ‚Ç¨ celkom`
                    : ''
                }
                gradient="linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%)"
              />
            </Grid>

            {/* Divider */}
            <Grid item xs={12}>
              <Divider className="/* TODO: Convert my: 2 */" />
            </Grid>

            {/* üöó TOP AUT√Å - Detailn√© rebr√≠ƒçky */}
            <Grid item xs={12}>
              <Typography
                variant="h5"
                className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 3 */ /* TODO: Convert color: #667eea */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
              >
                <CarIcon />
                üöó TOP Aut√° - Detailn√© rebr√≠ƒçky
              </Typography>
            </Grid>

            <Grid item xs={12} lg={4}>
              <TopListCard
                title="Najvy≈•a≈æenej≈°ie aut√°"
                icon={<SpeedIcon />}
                gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
                data={stats.vehiclesByUtilization as Record<string, unknown>[]}
                showCount={showVehiclesByUtilization}
                onLoadMore={() =>
                  setShowVehiclesByUtilization(prev => prev + 10)
                }
                renderItem={(vehicleData, index) => {
                  const vehicle = vehicleData as VehicleStatistic;
                  return (
                    <div
                      key={vehicle.vehicle?.id || index}
                      sx={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 2,
                        p: 2,
                        borderRadius: 2,
                        backgroundColor:
                          index < 3 ? 'rgba(102, 126, 234, 0.04)' : '#f8f9fa',
                        border:
                          index === 0
                            ? '2px solid #ffd700'
                            : '1px solid #e0e0e0',
                        transition: 'all 0.2s ease',
                        '&:hover': {
                          transform: 'translateX(4px)',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        },
                      }}
                    >
                      <div
                        className="/* TODO: Convert minWidth: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert background:
                            index < 3
                              ? linear-gradient(135deg */ /* TODO: Convert #764ba2 100%)
                              : #bdbdbd */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */ /* TODO: Convert fontSize: 0.9rem */"
                      >
                        {index + 1}
                      </div>

                      <Avatar
                        className="/* TODO: Convert width: 40 */ /* TODO: Convert height: 40 */ /* TODO: Convert bgcolor: #667eea */"
                      >
                        <CarIcon fontSize="small" />
                      </Avatar>

                      <div className="/* TODO: Convert flex: 1 */">
                        <Typography variant="body2" fontWeight="bold">
                          {vehicle.vehicle?.brand || 'N/A'}{' '}
                          {vehicle.vehicle?.model || ''}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {vehicle.vehicle?.licensePlate || 'N/A'} ‚Ä¢{' '}
                          {vehicle.totalDaysRented || 0} dn√≠
                        </Typography>
                      </div>

                      <div className="/* TODO: Convert textAlign: right */ /* TODO: Convert minWidth: 80 */">
                        <Typography
                          variant="h6"
                          fontWeight="bold"
                          className="/* TODO: Convert color:
                              (vehicle.utilizationPercentage || 0) > 70
                                ? #4caf50
                                : (vehicle.utilizationPercentage || 0) > 40
                                  ? #ff9800
                                  : #f44336 */"
                        >
                          {(vehicle.utilizationPercentage || 0).toFixed(1)}%
                        </Typography>
                        <LinearProgress
                          variant="determinate"
                          value={Math.min(
                            vehicle.utilizationPercentage || 0,
                            100
                          )}
                          sx={{
                            height: 6,
                            borderRadius: 3,
                            backgroundColor: '#e0e0e0',
                            '& .MuiLinearProgress-bar': {
                              background:
                                (vehicle.utilizationPercentage || 0) > 70
                                  ? '#4caf50'
                                  : (vehicle.utilizationPercentage || 0) > 40
                                    ? '#ff9800'
                                    : '#f44336',
                              borderRadius: 3,
                            },
                          }}
                        />
                      </div>
                    </div>
                  );
                }}
                emptyMessage="≈Ωiadne aut√° v tomto obdob√≠"
              />
            </Grid>

            <Grid item xs={12} lg={4}>
              <TopListCard
                title="Najv√Ωnosnej≈°ie aut√°"
                icon={<EuroIcon />}
                gradient="linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"
                data={stats.vehiclesByRevenue as Record<string, unknown>[]}
                showCount={showVehiclesByRevenue}
                onLoadMore={() => setShowVehiclesByRevenue(prev => prev + 10)}
                renderItem={(vehicleData, index) => {
                  const vehicle = vehicleData as VehicleStatistic;
                  return (
                    <div
                      key={vehicle.vehicle?.id || index}
                      sx={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 2,
                        p: 2,
                        borderRadius: 2,
                        backgroundColor:
                          index < 3 ? 'rgba(17, 153, 142, 0.04)' : '#f8f9fa',
                        border:
                          index === 0
                            ? '2px solid #ffd700'
                            : '1px solid #e0e0e0',
                        transition: 'all 0.2s ease',
                        '&:hover': {
                          transform: 'translateX(4px)',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        },
                      }}
                    >
                      <div
                        className="/* TODO: Convert minWidth: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert background:
                            index < 3
                              ? linear-gradient(135deg */ /* TODO: Convert #38ef7d 100%)
                              : #bdbdbd */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */ /* TODO: Convert fontSize: 0.9rem */"
                      >
                        {index + 1}
                      </div>

                      <Avatar
                        className="/* TODO: Convert width: 40 */ /* TODO: Convert height: 40 */ /* TODO: Convert bgcolor: #11998e */"
                      >
                        <CarIcon fontSize="small" />
                      </Avatar>

                      <div className="/* TODO: Convert flex: 1 */">
                        <Typography variant="body2" fontWeight="bold">
                          {vehicle.vehicle?.brand || 'N/A'}{' '}
                          {vehicle.vehicle?.model || ''}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {vehicle.vehicle?.licensePlate || 'N/A'} ‚Ä¢{' '}
                          {vehicle.rentalCount || 0} pren√°jmov
                        </Typography>
                      </div>

                      <div className="/* TODO: Convert textAlign: right */">
                        <Typography
                          variant="h6"
                          fontWeight="bold"
                          className="/* TODO: Convert color: #11998e */"
                        >
                          {(vehicle.totalRevenue || 0).toLocaleString()} ‚Ç¨
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {(vehicle.avgRevenuePerRental || 0).toFixed(0)}{' '}
                          ‚Ç¨/pren√°jom
                        </Typography>
                      </div>
                    </div>
                  );
                }}
                emptyMessage="≈Ωiadne aut√° v tomto obdob√≠"
              />
            </Grid>

            <Grid item xs={12} lg={4}>
              <TopListCard
                title="Najƒçastej≈°ie prenaj√≠man√©"
                icon={<CarIcon />}
                gradient="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"
                data={stats.vehiclesByRentals as Record<string, unknown>[]}
                showCount={showVehiclesByRentals}
                onLoadMore={() => setShowVehiclesByRentals(prev => prev + 10)}
                renderItem={(vehicleData, index) => {
                  const vehicle = vehicleData as VehicleStatistic;
                  return (
                    <div
                      key={vehicle.vehicle?.id || index}
                      sx={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 2,
                        p: 2,
                        borderRadius: 2,
                        backgroundColor:
                          index < 3 ? 'rgba(240, 147, 251, 0.04)' : '#f8f9fa',
                        border:
                          index === 0
                            ? '2px solid #ffd700'
                            : '1px solid #e0e0e0',
                        transition: 'all 0.2s ease',
                        '&:hover': {
                          transform: 'translateX(4px)',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        },
                      }}
                    >
                      <div
                        className="/* TODO: Convert minWidth: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert background:
                            index < 3
                              ? linear-gradient(135deg */ /* TODO: Convert #f5576c 100%)
                              : #bdbdbd */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */ /* TODO: Convert fontSize: 0.9rem */"
                      >
                        {index + 1}
                      </div>

                      <Avatar
                        className="/* TODO: Convert width: 40 */ /* TODO: Convert height: 40 */ /* TODO: Convert bgcolor: #f093fb */"
                      >
                        <CarIcon fontSize="small" />
                      </Avatar>

                      <div className="/* TODO: Convert flex: 1 */">
                        <Typography variant="body2" fontWeight="bold">
                          {vehicle.vehicle?.brand || 'N/A'}{' '}
                          {vehicle.vehicle?.model || ''}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {vehicle.vehicle?.licensePlate || 'N/A'} ‚Ä¢{' '}
                          {vehicle.totalDaysRented || 0} dn√≠ celkom
                        </Typography>
                      </div>

                      <div className="/* TODO: Convert textAlign: right */">
                        <Typography
                          variant="h6"
                          fontWeight="bold"
                          className="/* TODO: Convert color: #f093fb */"
                        >
                          {vehicle.rentalCount || 0}x
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {(vehicle.totalRevenue || 0).toLocaleString()} ‚Ç¨
                          celkom
                        </Typography>
                      </div>
                    </div>
                  );
                }}
                emptyMessage="≈Ωiadne aut√° v tomto obdob√≠"
              />
            </Grid>

            {/* Divider */}
            <Grid item xs={12}>
              <Divider className="/* TODO: Convert my: 2 */" />
            </Grid>

            {/* üë• TOP Z√ÅKAZN√çCI - Detailn√© rebr√≠ƒçky */}
            <Grid item xs={12}>
              <Typography
                variant="h5"
                className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 3 */ /* TODO: Convert color: #667eea */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
              >
                <PersonIcon />
                üë• TOP Z√°kazn√≠ci - Detailn√© rebr√≠ƒçky
              </Typography>
            </Grid>

            <Grid item xs={12} lg={4}>
              <TopListCard
                title="Najakt√≠vnej≈°√≠ z√°kazn√≠ci"
                icon={<StarIcon />}
                gradient="linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%)"
                data={stats.customersByRentals as Record<string, unknown>[]}
                showCount={showCustomersByRentals}
                onLoadMore={() => setShowCustomersByRentals(prev => prev + 10)}
                renderItem={(customerData, index) => {
                  const customer = customerData as CustomerStatistic;
                  return (
                    <div
                      key={customer.customerName || index}
                      sx={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 2,
                        p: 2,
                        borderRadius: 2,
                        backgroundColor:
                          index < 3 ? 'rgba(255, 154, 158, 0.04)' : '#f8f9fa',
                        border:
                          index === 0
                            ? '2px solid #ffd700'
                            : '1px solid #e0e0e0',
                        transition: 'all 0.2s ease',
                        '&:hover': {
                          transform: 'translateX(4px)',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        },
                      }}
                    >
                      <div
                        className="/* TODO: Convert minWidth: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert background:
                            index < 3
                              ? linear-gradient(135deg */ /* TODO: Convert #fad0c4 100%)
                              : #bdbdbd */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */ /* TODO: Convert fontSize: 0.9rem */"
                      >
                        {index + 1}
                      </div>

                      <Avatar
                        className="/* TODO: Convert width: 40 */ /* TODO: Convert height: 40 */ /* TODO: Convert bgcolor: #ff9a9e */"
                      >
                        <PersonIcon fontSize="small" />
                      </Avatar>

                      <div className="/* TODO: Convert flex: 1 */">
                        <Typography variant="body2" fontWeight="bold">
                          {customer.customerName || 'N/A'}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {customer.totalDaysRented || 0} dn√≠ celkom ‚Ä¢ Priemer:{' '}
                          {(customer.avgRentalDuration || 0).toFixed(1)} dn√≠
                        </Typography>
                      </div>

                      <div className="/* TODO: Convert textAlign: right */">
                        <Typography
                          variant="h6"
                          fontWeight="bold"
                          className="/* TODO: Convert color: #ff9a9e */"
                        >
                          {customer.rentalCount || 0}x
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {(customer.totalRevenue || 0).toLocaleString()} ‚Ç¨
                          celkom
                        </Typography>
                      </div>
                    </div>
                  );
                }}
                emptyMessage="≈Ωiadni z√°kazn√≠ci v tomto obdob√≠"
              />
            </Grid>

            <Grid item xs={12} lg={4}>
              <TopListCard
                title="Najziskovej≈°√≠ z√°kazn√≠ci"
                icon={<MoneyIcon />}
                gradient="linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)"
                data={stats.customersByRevenue as Record<string, unknown>[]}
                showCount={showCustomersByRevenue}
                onLoadMore={() => setShowCustomersByRevenue(prev => prev + 10)}
                renderItem={(customerData, index) => {
                  const customer = customerData as CustomerStatistic;
                  return (
                    <div
                      key={customer.customerName || index}
                      sx={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 2,
                        p: 2,
                        borderRadius: 2,
                        backgroundColor:
                          index < 3 ? 'rgba(255, 107, 107, 0.04)' : '#f8f9fa',
                        border:
                          index === 0
                            ? '2px solid #ffd700'
                            : '1px solid #e0e0e0',
                        transition: 'all 0.2s ease',
                        '&:hover': {
                          transform: 'translateX(4px)',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        },
                      }}
                    >
                      <div
                        className="/* TODO: Convert minWidth: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert background:
                            index < 3
                              ? linear-gradient(135deg */ /* TODO: Convert #ee5a24 100%)
                              : #bdbdbd */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */ /* TODO: Convert fontSize: 0.9rem */"
                      >
                        {index + 1}
                      </div>

                      <Avatar
                        className="/* TODO: Convert width: 40 */ /* TODO: Convert height: 40 */ /* TODO: Convert bgcolor: #ff6b6b */"
                      >
                        <PersonIcon fontSize="small" />
                      </Avatar>

                      <div className="/* TODO: Convert flex: 1 */">
                        <Typography variant="body2" fontWeight="bold">
                          {customer.customerName || 'N/A'}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {customer.rentalCount || 0} pren√°jmov ‚Ä¢{' '}
                          {customer.totalDaysRented || 0} dn√≠
                        </Typography>
                      </div>

                      <div className="/* TODO: Convert textAlign: right */">
                        <Typography
                          variant="h6"
                          fontWeight="bold"
                          className="/* TODO: Convert color: #ff6b6b */"
                        >
                          {(customer.totalRevenue || 0).toLocaleString()} ‚Ç¨
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {(
                            (customer.totalRevenue || 0) /
                            (customer.rentalCount || 1)
                          ).toFixed(0)}{' '}
                          ‚Ç¨/pren√°jom
                        </Typography>
                      </div>
                    </div>
                  );
                }}
                emptyMessage="≈Ωiadni z√°kazn√≠ci v tomto obdob√≠"
              />
            </Grid>

            <Grid item xs={12} lg={4}>
              <TopListCard
                title="Najdlhodobej≈°√≠ z√°kazn√≠ci"
                icon={<TimeIcon />}
                gradient="linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"
                data={stats.customersByDays as Record<string, unknown>[]}
                showCount={showCustomersByDays}
                onLoadMore={() => setShowCustomersByDays(prev => prev + 10)}
                renderItem={(customerData, index) => {
                  const customer = customerData as CustomerStatistic;
                  return (
                    <div
                      key={customer.customerName || index}
                      sx={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 2,
                        p: 2,
                        borderRadius: 2,
                        backgroundColor:
                          index < 3 ? 'rgba(79, 172, 254, 0.04)' : '#f8f9fa',
                        border:
                          index === 0
                            ? '2px solid #ffd700'
                            : '1px solid #e0e0e0',
                        transition: 'all 0.2s ease',
                        '&:hover': {
                          transform: 'translateX(4px)',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        },
                      }}
                    >
                      <div
                        className="/* TODO: Convert minWidth: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert background:
                            index < 3
                              ? linear-gradient(135deg */ /* TODO: Convert #00f2fe 100%)
                              : #bdbdbd */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */ /* TODO: Convert fontSize: 0.9rem */"
                      >
                        {index + 1}
                      </div>

                      <Avatar
                        className="/* TODO: Convert width: 40 */ /* TODO: Convert height: 40 */ /* TODO: Convert bgcolor: #4facfe */"
                      >
                        <PersonIcon fontSize="small" />
                      </Avatar>

                      <div className="/* TODO: Convert flex: 1 */">
                        <Typography variant="body2" fontWeight="bold">
                          {customer.customerName || 'N/A'}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {customer.rentalCount || 0} pren√°jmov ‚Ä¢{' '}
                          {(customer.totalRevenue || 0).toLocaleString()} ‚Ç¨
                        </Typography>
                      </div>

                      <div className="/* TODO: Convert textAlign: right */">
                        <Typography
                          variant="h6"
                          fontWeight="bold"
                          className="/* TODO: Convert color: #4facfe */"
                        >
                          {customer.totalDaysRented || 0} dn√≠
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          Priemer:{' '}
                          {(customer.avgRentalDuration || 0).toFixed(1)}{' '}
                          dn√≠/pren√°jom
                        </Typography>
                      </div>
                    </div>
                  );
                }}
                emptyMessage="≈Ωiadni z√°kazn√≠ci v tomto obdob√≠"
              />
            </Grid>
          </Grid>
        </TabPanel>

        {/* Tab 6: Zamestnanci */}
        <TabPanel value={tabValue} index={5}>
          <Grid container spacing={3}>
            {/* Header */}
            <Grid item xs={12}>
              <Typography
                variant="h5"
                className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 3 */ /* TODO: Convert color: #667eea */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
              >
                <PersonIcon />
                V√Ωkon zamestnancov za obdobie: {formatPeriod()}
              </Typography>
            </Grid>

            {/* Employee Statistics Cards */}
            {stats.employeeStats && stats.employeeStats.activeEmployees > 0 ? (
              <>
                {/* Summary Stats */}
                <Grid item xs={12}>
                  <Grid container spacing={2}>
                    <Grid item xs={12} sm={6} md={3}>
                      <Card
                        className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */ /* TODO: Convert background:
                            linear-gradient(135deg */ /* TODO: Convert color: white */"
                      >
                        <CardContent className="/* TODO: Convert textAlign: center */">
                          <Typography
                            variant="h4"
                            className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 1 */"
                          >
                            {stats.employeeStats.totalProtocols}
                          </Typography>
                          <Typography variant="body2">
                            Celkovo protokolov
                          </Typography>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} sm={6} md={3}>
                      <Card
                        className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */ /* TODO: Convert background:
                            linear-gradient(135deg */ /* TODO: Convert color: white */"
                      >
                        <CardContent className="/* TODO: Convert textAlign: center */">
                          <Typography
                            variant="h4"
                            className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 1 */"
                          >
                            {stats.employeeStats.totalHandovers}
                          </Typography>
                          <Typography variant="body2">Odovzdan√≠</Typography>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} sm={6} md={3}>
                      <Card
                        className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */ /* TODO: Convert background:
                            linear-gradient(135deg */ /* TODO: Convert color: white */"
                      >
                        <CardContent className="/* TODO: Convert textAlign: center */">
                          <Typography
                            variant="h4"
                            className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 1 */"
                          >
                            {stats.employeeStats.totalReturns}
                          </Typography>
                          <Typography variant="body2">Prebran√≠</Typography>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} sm={6} md={3}>
                      <Card
                        className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */ /* TODO: Convert background:
                            linear-gradient(135deg */ /* TODO: Convert color: white */"
                      >
                        <CardContent className="/* TODO: Convert textAlign: center */">
                          <Typography
                            variant="h4"
                            className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert mb: 1 */"
                          >
                            {stats.employeeStats.activeEmployees}
                          </Typography>
                          <Typography variant="body2">
                            Akt√≠vnych zamestnancov
                          </Typography>
                        </CardContent>
                      </Card>
                    </Grid>
                  </Grid>
                </Grid>

                {/* Top Employees by Protocols */}
                <Grid item xs={12} lg={6}>
                  <Card
                    className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */ /* TODO: Convert height: 100% */"
                  >
                    <CardContent>
                      <Typography
                        variant="h6"
                        className="/* TODO: Convert fontWeight: 600 */ /* TODO: Convert mb: 2 */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
                      >
                        <TrophyIcon />
                        Top zamestnanci (protokoly)
                      </Typography>
                      <div className="/* TODO: Convert maxHeight: 400 */ /* TODO: Convert overflowY: auto */">
                        {stats.employeeStats.topEmployeesByProtocols
                          .slice(0, 10)
                          .map(
                            (
                              employeeData: Record<string, unknown>,
                              index: number
                            ) => {
                              const employee =
                                employeeData as EmployeeStatistic;
                              return (
                                <div
                                  key={employee.employeeName || index}
                                  className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */ p-4 /* TODO: Convert mb: 1 */ /* TODO: Convert bgcolor:
                                      index < 3
                                        ? rgba(102 */ /* TODO: Convert 0.1)
                                        : background.paper */ rounded-md /* TODO: Convert border:
                                      index < 3
                                        ? 1px solid rgba(102 */ /* TODO: Convert 0.2)
                                        : 1px solid rgba(0 */"
                                >
                                  <div
                                    className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4"
                                  >
                                    <div
                                      className="/* TODO: Convert width: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert bgcolor:
                                          index === 0
                                            ? #FFD700
                                            : index === 1
                                              ? #C0C0C0
                                              : index === 2
                                                ? #CD7F32
                                                : #667eea */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */"
                                    >
                                      {index + 1}
                                    </div>
                                    <div>
                                      <Typography
                                        variant="body1"
                                        className="/* TODO: Convert fontWeight: 600 */"
                                      >
                                        {employee.employeeName || 'N/A'}
                                      </Typography>
                                      <Typography
                                        variant="caption"
                                        color="text.secondary"
                                      >
                                        {employee.handoverCount || 0} odovzdan√≠
                                        ‚Ä¢ {employee.returnCount || 0} prebran√≠
                                      </Typography>
                                    </div>
                                  </div>
                                  <Typography
                                    variant="h6"
                                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #667eea */"
                                  >
                                    {employee.totalProtocols || 0}
                                  </Typography>
                                </div>
                              );
                            }
                          )}
                      </div>
                    </CardContent>
                  </Card>
                </Grid>

                {/* Top Employees by Revenue */}
                <Grid item xs={12} lg={6}>
                  <Card
                    className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */ /* TODO: Convert height: 100% */"
                  >
                    <CardContent>
                      <Typography
                        variant="h6"
                        className="/* TODO: Convert fontWeight: 600 */ /* TODO: Convert mb: 2 */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
                      >
                        <EuroIcon />
                        Top zamestnanci (tr≈æby)
                      </Typography>
                      <div className="/* TODO: Convert maxHeight: 400 */ /* TODO: Convert overflowY: auto */">
                        {stats.employeeStats.topEmployeesByRevenue
                          .slice(0, 10)
                          .map(
                            (
                              employeeData: Record<string, unknown>,
                              index: number
                            ) => {
                              const employee =
                                employeeData as EmployeeStatistic;
                              return (
                                <div
                                  key={employee.employeeName || index}
                                  className="/* TODO: Convert display: flex */ /* TODO: Convert justifyContent: space-between */ /* TODO: Convert alignItems: center */ p-4 /* TODO: Convert mb: 1 */ /* TODO: Convert bgcolor:
                                      index < 3
                                        ? rgba(76 */ /* TODO: Convert 0.1)
                                        : background.paper */ rounded-md /* TODO: Convert border:
                                      index < 3
                                        ? 1px solid rgba(76 */ /* TODO: Convert 0.2)
                                        : 1px solid rgba(0 */"
                                >
                                  <div
                                    className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-4"
                                  >
                                    <div
                                      className="/* TODO: Convert width: 32 */ /* TODO: Convert height: 32 */ /* TODO: Convert borderRadius: 50% */ /* TODO: Convert bgcolor:
                                          index === 0
                                            ? #FFD700
                                            : index === 1
                                              ? #C0C0C0
                                              : index === 2
                                                ? #CD7F32
                                                : #4CAF50 */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ /* TODO: Convert justifyContent: center */ /* TODO: Convert color: white */ /* TODO: Convert fontWeight: 700 */"
                                    >
                                      {index + 1}
                                    </div>
                                    <div>
                                      <Typography
                                        variant="body1"
                                        className="/* TODO: Convert fontWeight: 600 */"
                                      >
                                        {employee.employeeName || 'N/A'}
                                      </Typography>
                                      <Typography
                                        variant="caption"
                                        color="text.secondary"
                                      >
                                        {employee.totalProtocols || 0}{' '}
                                        protokolov
                                      </Typography>
                                    </div>
                                  </div>
                                  <Typography
                                    variant="h6"
                                    className="/* TODO: Convert fontWeight: 700 */ /* TODO: Convert color: #4CAF50 */"
                                  >
                                    ‚Ç¨
                                    {(
                                      employee.totalRevenue || 0
                                    ).toLocaleString()}
                                  </Typography>
                                </div>
                              );
                            }
                          )}
                      </div>
                    </CardContent>
                  </Card>
                </Grid>

                {/* Detailed Employee Table */}
                <Grid item xs={12}>
                  <Card className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */">
                    <CardContent>
                      <Typography
                        variant="h6"
                        className="/* TODO: Convert fontWeight: 600 */ /* TODO: Convert mb: 2 */ /* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
                      >
                        <AssessmentIcon />
                        Detailn√© ≈°tatistiky zamestnancov
                      </Typography>
                      <TableContainer>
                        <Table>
                          <TableHead>
                            <TableRow>
                              <TableCell className="/* TODO: Convert fontWeight: 600 */">
                                Zamestnanec
                              </TableCell>
                              <TableCell
                                align="center"
                                className="/* TODO: Convert fontWeight: 600 */"
                              >
                                Protokoly
                              </TableCell>
                              <TableCell
                                align="center"
                                className="/* TODO: Convert fontWeight: 600 */"
                              >
                                Odovzdania
                              </TableCell>
                              <TableCell
                                align="center"
                                className="/* TODO: Convert fontWeight: 600 */"
                              >
                                Prebrania
                              </TableCell>
                              <TableCell align="right" className="/* TODO: Convert fontWeight: 600 */">
                                Tr≈æby
                              </TableCell>
                              <TableCell
                                align="center"
                                className="/* TODO: Convert fontWeight: 600 */"
                              >
                                Pren√°jmy
                              </TableCell>
                            </TableRow>
                          </TableHead>
                          <TableBody>
                            {stats.employeeStats.allEmployees
                              .sort(
                                (a, b) =>
                                  (b.totalProtocols || 0) -
                                  (a.totalProtocols || 0)
                              )
                              .map(
                                (
                                  employeeData: Record<string, unknown>,
                                  index: number
                                ) => {
                                  const employee =
                                    employeeData as EmployeeStatistic;
                                  return (
                                    <TableRow
                                      key={employee.employeeName || index}
                                      sx={{
                                        '&:nth-of-type(odd)': {
                                          backgroundColor:
                                            'rgba(0, 0, 0, 0.04)',
                                        },
                                      }}
                                    >
                                      <TableCell>
                                        <div
                                          className="/* TODO: Convert display: flex */ /* TODO: Convert alignItems: center */ gap-2"
                                        >
                                          <PersonIcon color="primary" />
                                          <Typography
                                            variant="body2"
                                            className="/* TODO: Convert fontWeight: 600 */"
                                          >
                                            {employee.employeeName || 'N/A'}
                                          </Typography>
                                        </div>
                                      </TableCell>
                                      <TableCell align="center">
                                        <Chip
                                          label={employee.totalProtocols || 0}
                                          color="primary"
                                          size="small"
                                        />
                                      </TableCell>
                                      <TableCell align="center">
                                        <Chip
                                          label={employee.handoverCount || 0}
                                          color="secondary"
                                          size="small"
                                        />
                                      </TableCell>
                                      <TableCell align="center">
                                        <Chip
                                          label={employee.returnCount || 0}
                                          color="info"
                                          size="small"
                                        />
                                      </TableCell>
                                      <TableCell align="right">
                                        <Typography
                                          variant="body2"
                                          className="/* TODO: Convert fontWeight: 600 */ /* TODO: Convert color: #4CAF50 */"
                                        >
                                          ‚Ç¨
                                          {(
                                            employee.totalRevenue || 0
                                          ).toLocaleString()}
                                        </Typography>
                                      </TableCell>
                                      <TableCell align="center">
                                        <Typography variant="body2">
                                          {employee.uniqueRentals || 0}
                                        </Typography>
                                      </TableCell>
                                    </TableRow>
                                  );
                                }
                              )}
                          </TableBody>
                        </Table>
                      </TableContainer>
                    </CardContent>
                  </Card>
                </Grid>
              </>
            ) : (
              <Grid item xs={12}>
                <Card className="/* TODO: Convert boxShadow: 0 2px 8px rgba(0 */">
                  <CardContent className="/* TODO: Convert textAlign: center */ /* TODO: Convert py: 4 */">
                    <PersonIcon
                      className="/* TODO: Convert fontSize: 64 */ /* TODO: Convert color: text.secondary */ /* TODO: Convert mb: 2 */"
                    />
                    <Typography
                      variant="h6"
                      color="text.secondary"
                      className="/* TODO: Convert mb: 1 */"
                    >
                      ≈Ωiadne protokoly za vybran√© obdobie
                    </Typography>
                    <Typography variant="body2" color="text.secondary">
                      V tomto obdob√≠ neboli vytvoren√© ≈æiadne protokoly
                      odovzd√°vania alebo preberania vozidiel.
                    </Typography>
                  </CardContent>
                </Card>
              </Grid>
            )}
          </Grid>
        </TabPanel>
      </Card>
    </div>
  );
};

export default Statistics;
