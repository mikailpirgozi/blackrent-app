const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DfP_Aygt.js","assets/index-3GiN0UBQ.css"])))=>i.map(i=>d[i]);
import{c as de,j as e,a6 as _e,a as d,B as s,q as S,M as $,N as G,O as Z,P as y,t as b,a7 as Ue,H as ce,J as fe,K as ve,Q as ge,T as i,A as qe,ad as $e,C as H,L as et,ae as tt,z as ye,D as je,o as X,F as at,I as Q,E as be,G as Ce,a0 as Ge,R as ke,av as nt,Z as M,U as rt,a8 as Se,a9 as Qe,aK as ie,a1 as vt,a3 as gt,a4 as yt,$ as te,ax as jt}from"./index-DfP_Aygt.js";import{G as c}from"./Grid-Bdewy4dZ.js";import{U as st}from"./Cancel-T9g0rbRj.js";import{G as Ye}from"./PlayArrow-BrNvuBNx.js";import{E as ot}from"./Euro-BjdjzfLF.js";import{C as lt}from"./Business-CW2_TAXE.js";import{E as bt}from"./Event-CsN4w7z0.js";import{S as Ct}from"./Switch-Bee8sYsg.js";import{F as kt,P as St}from"./papaparse.min-GJxd3uti.js";import{R as ae}from"./Receipt-CvIXthAy.js";import{S as It}from"./Settings-IgKCPozF.js";import{S as wt}from"./Search-wmGxveR5.js";import{F as zt}from"./FilterList-FhaE75z2.js";import{S as Dt}from"./Security-D9d1EOYw.js";import{M as Wt}from"./Build-D9Ysn6mJ.js";const Le=de([e.jsx("path",{d:"m12 2-5.5 9h11z"},"0"),e.jsx("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),e.jsx("path",{d:"M3 13.5h8v8H3z"},"2")],"Category"),Et=de(e.jsx("path",{d:"M9 11H7v2h2zm4 0h-2v2h2zm4 0h-2v2h2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V9h14z"}),"DateRange"),Ft=de(e.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"DragIndicator"),Nt=de(e.jsx("path",{d:"m19.77 7.23.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77M12 10H6V5h6zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"LocalGasStation"),Re=de(e.jsx("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2z"}),"Repeat");function Pt({expense:p,onSave:D,onCancel:E,categories:I=[]}){const{state:A,dispatch:F,createCompany:N}=_e(),[O,P]=d.useState(!1),[m,j]=d.useState(""),[u,f]=d.useState({description:"",amount:0,date:new Date,vehicleId:"",company:"",category:"other",note:""});d.useEffect(()=>{p&&f(p)},[p]);const g=(n,x)=>{f(L=>({...L,[n]:x}))},T=n=>{n.preventDefault();const x={id:p?.id||Ue(),description:u.description||"",amount:u.amount||0,date:u.date||new Date,vehicleId:u.vehicleId||void 0,company:u.company||"",category:u.category||"other",note:u.note||void 0};D(x)};return e.jsxs(s,{component:"form",onSubmit:T,sx:{mt:2},children:[e.jsxs(s,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:3},children:[e.jsx(S,{fullWidth:!0,label:"Popis",value:u.description,onChange:n=>g("description",n.target.value),required:!0}),e.jsx(S,{fullWidth:!0,label:"Suma (‚Ç¨) - voliteƒæn√©",type:"number",value:u.amount||"",onChange:n=>g("amount",n.target.value?parseFloat(n.target.value):0),placeholder:"Zadajte sumu alebo nechajte pr√°zdne"}),e.jsx(S,{fullWidth:!0,label:"D√°tum",type:"date",value:u.date?new Date(u.date).toISOString().split("T")[0]:"",onChange:n=>g("date",new Date(n.target.value)),InputLabelProps:{shrink:!0},required:!0}),e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Kateg√≥ria"}),e.jsx(Z,{value:u.category,onChange:n=>g("category",n.target.value),label:"Kateg√≥ria",required:!0,children:I.length>0?I.map(n=>e.jsx(y,{value:n.name,children:n.displayName},n.name)):e.jsxs(e.Fragment,{children:[e.jsx(y,{value:"service",children:"Servis"}),e.jsx(y,{value:"insurance",children:"Poistenie"}),e.jsx(y,{value:"fuel",children:"Palivo"}),e.jsx(y,{value:"other",children:"In√©"})]})})]}),e.jsxs($,{fullWidth:!0,required:!0,children:[e.jsx(G,{children:"Firma"}),e.jsxs(Z,{value:u.company||"",label:"Firma",onChange:n=>g("company",n.target.value),renderValue:n=>n||"Vyberte firmu",children:[Array.from(new Set([...A.companies.map(n=>n.name),...A.vehicles.map(n=>n.company),...A.expenses.map(n=>n.company)])).filter(Boolean).sort((n,x)=>n.localeCompare(x)).map(n=>e.jsx(y,{value:n,children:n},n)),e.jsx(y,{value:"__add_new__",onClick:()=>P(!0),children:e.jsx("em",{children:"+ Prida≈• nov√∫ firmu"})})]}),O&&e.jsxs(s,{sx:{display:"flex",gap:1,mt:1},children:[e.jsx(S,{autoFocus:!0,size:"small",label:"Nov√° firma",value:m,onChange:n=>j(n.target.value)}),e.jsx(b,{variant:"contained",size:"small",disabled:!m.trim(),onClick:async()=>{try{const n=Ue();await N({id:n,name:m.trim(),commissionRate:20,isActive:!0,createdAt:new Date}),f(x=>({...x,company:m.trim()})),j(""),P(!1)}catch(n){console.error("Chyba pri vytv√°ran√≠ firmy:",n),alert("Chyba pri vytv√°ran√≠ firmy")}},children:"Prida≈•"}),e.jsx(b,{variant:"outlined",size:"small",onClick:()=>{P(!1),j("")},children:"Zru≈°i≈•"})]})]}),e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Vozidlo (voliteƒæn√©)"}),e.jsxs(Z,{value:u.vehicleId||"",onChange:n=>g("vehicleId",n.target.value||void 0),label:"Vozidlo (voliteƒæn√©)",children:[e.jsx(y,{value:"",children:"V≈°etky vozidl√°"}),A.vehicles.map(n=>e.jsxs(y,{value:n.id,children:[n.brand," ",n.model," (",n.licensePlate,")"]},n.id))]})]}),e.jsx(S,{fullWidth:!0,label:"Pozn√°mka (voliteƒæn√©)",value:u.note||"",onChange:n=>g("note",n.target.value),multiline:!0,rows:3,placeholder:"Zadajte dodatoƒçn√© inform√°cie k n√°kladu..."})]}),e.jsxs(s,{sx:{gridColumn:"1 / -1",display:"flex",gap:2,justifyContent:"flex-end",mt:3},children:[e.jsx(b,{variant:"outlined",onClick:E,children:"Zru≈°i≈•"}),e.jsx(b,{type:"submit",variant:"contained",children:p?"Ulo≈æi≈• zmeny":"Prida≈• n√°klad"})]})]})}const Vt=[{value:"receipt",label:"√öƒçtenka",icon:"üßæ"},{value:"local_gas_station",label:"Palivo",icon:"‚õΩ"},{value:"build",label:"Servis",icon:"üîß"},{value:"security",label:"Poistenie",icon:"üõ°Ô∏è"},{value:"category",label:"Kateg√≥ria",icon:"üìÇ"},{value:"euro",label:"Euro",icon:"üí∂"},{value:"shopping_cart",label:"N√°kup",icon:"üõí"},{value:"home",label:"Dom",icon:"üè†"},{value:"work",label:"Pr√°ca",icon:"üíº"},{value:"restaurant",label:"Re≈°taur√°cia",icon:"üçΩÔ∏è"},{value:"local_hospital",label:"Nemocnica",icon:"üè•"},{value:"school",label:"≈†kola",icon:"üè´"},{value:"fitness_center",label:"Fitness",icon:"üí™"},{value:"phone",label:"Telef√≥n",icon:"üì±"},{value:"computer",label:"Poƒç√≠taƒç",icon:"üíª"},{value:"flight",label:"Let",icon:"‚úàÔ∏è"},{value:"hotel",label:"Hotel",icon:"üè®"},{value:"local_taxi",label:"Taxi",icon:"üöï"},{value:"train",label:"Vlak",icon:"üöÜ"},{value:"directions_bus",label:"Autobus",icon:"üöå"}],At=[{value:"primary",label:"Modr√°",color:"#1976d2"},{value:"secondary",label:"Fialov√°",color:"#9c27b0"},{value:"success",label:"Zelen√°",color:"#2e7d32"},{value:"error",label:"ƒåerven√°",color:"#d32f2f"},{value:"warning",label:"Oran≈æov√°",color:"#ed6c02"},{value:"info",label:"Svetlomodr√°",color:"#0288d1"}],Ot=({open:p,onClose:D,onCategoriesChanged:E})=>{const[I,A]=d.useState([]),[F,N]=d.useState(!1),[O,P]=d.useState(!1),[m,j]=d.useState(null),[u,f]=d.useState(null),[g,T]=d.useState(null),[n,x]=d.useState({name:"",displayName:"",description:"",icon:"receipt",color:"primary",sortOrder:0}),L=async()=>{N(!0),f(null);try{const r=await M.getExpenseCategories();A(r)}catch(r){f("Chyba pri naƒç√≠tavan√≠ kateg√≥ri√≠: "+r.message)}finally{N(!1)}};d.useEffect(()=>{p&&L()},[p]);const R=()=>{x({name:"",displayName:"",description:"",icon:"receipt",color:"primary",sortOrder:I.length}),j(null)},o=()=>{R(),P(!0)},v=r=>{x({name:r.name,displayName:r.displayName,description:r.description||"",icon:r.icon,color:r.color,sortOrder:r.sortOrder}),j(r),P(!0)},_=async r=>{if(r.isDefault){f("Nemo≈æno zmaza≈• z√°kladn√∫ kateg√≥riu");return}if(window.confirm(`Naozaj chcete zmaza≈• kateg√≥riu "${r.displayName}"?`)){N(!0),f(null);try{await M.deleteExpenseCategory(r.id),T("Kateg√≥ria √∫spe≈°ne zmazan√°"),await L(),E?.()}catch(C){f("Chyba pri mazan√≠ kateg√≥rie: "+C.message)}finally{N(!1)}}},Y=async()=>{if(!n.displayName.trim()){f("Zobrazovan√Ω n√°zov je povinn√Ω");return}N(!0),f(null);try{if(m){const r={...m,displayName:n.displayName.trim(),description:n.description.trim()||void 0,icon:n.icon,color:n.color,sortOrder:n.sortOrder};await M.updateExpenseCategory(r),T("Kateg√≥ria √∫spe≈°ne aktualizovan√°")}else await M.createExpenseCategory({name:n.name||n.displayName.toLowerCase().replace(/\s+/g,"_"),displayName:n.displayName.trim(),description:n.description.trim()||void 0,icon:n.icon,color:n.color,sortOrder:n.sortOrder}),T("Kateg√≥ria √∫spe≈°ne vytvoren√°");P(!1),await L(),E?.()}catch(r){f("Chyba pri ukladan√≠ kateg√≥rie: "+r.message)}finally{N(!1)}},ne=()=>{P(!1),R(),f(null)};return e.jsxs(ce,{open:p,onClose:D,maxWidth:"md",fullWidth:!0,children:[e.jsxs(fe,{sx:{display:"flex",alignItems:"center",gap:1,backgroundColor:"#f5f5f5",borderBottom:"1px solid #e0e0e0"},children:[e.jsx(Le,{sx:{color:"#1976d2"}}),"Spr√°va kateg√≥ri√≠ n√°kladov"]}),e.jsxs(ve,{sx:{p:3},children:[u&&e.jsx(ge,{severity:"error",sx:{mb:2},onClose:()=>f(null),children:u}),g&&e.jsx(ge,{severity:"success",sx:{mb:2},onClose:()=>T(null),children:g}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(i,{variant:"h6",sx:{fontWeight:600},children:["Existuj√∫ce kateg√≥rie (",I.length,")"]}),e.jsx(b,{variant:"contained",startIcon:e.jsx(qe,{}),onClick:o,disabled:F,children:"Prida≈• kateg√≥riu"})]}),F&&e.jsx(s,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx($e,{})}),e.jsx(H,{sx:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(et,{children:[I.map((r,C)=>e.jsxs(tt.Fragment,{children:[e.jsxs(ye,{sx:{py:2,"&:hover":{backgroundColor:"#f5f5f5"}},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mr:2},children:[e.jsx(Ft,{sx:{color:"text.secondary",cursor:"grab"}}),e.jsx(i,{variant:"body2",sx:{minWidth:30,textAlign:"center",fontWeight:600,color:"text.secondary"},children:r.sortOrder})]}),e.jsx(je,{primary:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(X,{label:r.displayName,color:r.color,size:"small",sx:{fontWeight:600}}),r.isDefault&&e.jsx(X,{label:"Z√°kladn√°",size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}})]}),secondary:e.jsxs(s,{sx:{mt:.5},children:[e.jsxs(i,{variant:"body2",color:"text.secondary",children:["ID: ",r.name," | Ikona: ",r.icon]}),r.description&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:r.description})]})}),e.jsx(at,{children:e.jsxs(s,{sx:{display:"flex",gap:.5},children:[e.jsx(Q,{size:"small",onClick:()=>v(r),disabled:F,sx:{backgroundColor:"#f5f5f5","&:hover":{backgroundColor:"#e0e0e0"}},children:e.jsx(be,{fontSize:"small"})}),!r.isDefault&&e.jsx(Q,{size:"small",onClick:()=>_(r),disabled:F,sx:{backgroundColor:"#ffebee",color:"#d32f2f","&:hover":{backgroundColor:"#ffcdd2"}},children:e.jsx(Ce,{fontSize:"small"})})]})})]}),C<I.length-1&&e.jsx(Ge,{})]},r.id)),I.length===0&&!F&&e.jsx(ye,{children:e.jsx(je,{primary:e.jsx(i,{variant:"body1",color:"text.secondary",sx:{textAlign:"center",py:2},children:"≈Ωiadne kateg√≥rie nen√°jden√©"})})})]})})]}),e.jsx(ke,{sx:{p:3,backgroundColor:"#f5f5f5"},children:e.jsx(b,{onClick:D,variant:"outlined",children:"Zavrie≈•"})}),e.jsxs(ce,{open:O,onClose:ne,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(fe,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Le,{}),m?"Upravi≈• kateg√≥riu":"Prida≈• kateg√≥riu"]}),e.jsx(ve,{sx:{pt:2},children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Zobrazovan√Ω n√°zov *",value:n.displayName,onChange:r=>x(C=>({...C,displayName:r.target.value,name:r.target.value.toLowerCase().replace(/\s+/g,"_")})),required:!0,helperText:"N√°zov ktor√Ω sa zobraz√≠ v aplik√°cii"})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Syst√©mov√Ω n√°zov",value:n.name,onChange:r=>x(C=>({...C,name:r.target.value})),helperText:"Automaticky generovan√Ω z zobrazovan√©ho n√°zvu",disabled:!!m})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Popis",value:n.description,onChange:r=>x(C=>({...C,description:r.target.value})),multiline:!0,rows:2,helperText:"Voliteƒæn√Ω popis kateg√≥rie"})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Ikona"}),e.jsx(Z,{value:n.icon,onChange:r=>x(C=>({...C,icon:r.target.value})),label:"Ikona",children:Vt.map(r=>e.jsx(y,{value:r.value,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:r.icon}),r.label]})},r.value))})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Farba"}),e.jsx(Z,{value:n.color,onChange:r=>x(C=>({...C,color:r.target.value})),label:"Farba",children:At.map(r=>e.jsx(y,{value:r.value,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(s,{sx:{width:16,height:16,borderRadius:"50%",backgroundColor:r.color}}),r.label]})},r.value))})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Poradie",type:"number",value:n.sortOrder,onChange:r=>x(C=>({...C,sortOrder:parseInt(r.target.value)||0})),helperText:"Poradie zobrazovania v zoznamoch"})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(s,{sx:{p:2,backgroundColor:"#f5f5f5",borderRadius:1,border:"1px solid #e0e0e0"},children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"N√°hƒæad:"}),e.jsx(X,{label:n.displayName||"N√°zov kateg√≥rie",color:n.color,size:"medium",sx:{fontWeight:600}})]})})]})}),e.jsxs(ke,{sx:{p:3,gap:1},children:[e.jsx(b,{onClick:ne,variant:"outlined",startIcon:e.jsx(st,{}),children:"Zru≈°i≈•"}),e.jsx(b,{onClick:Y,variant:"contained",startIcon:e.jsx(nt,{}),disabled:F||!n.displayName.trim(),children:m?"Aktualizova≈•":"Vytvori≈•"})]})]})]})},Je=[{value:"monthly",label:"Mesaƒçne",icon:"üìÖ"},{value:"quarterly",label:"≈†tvr≈•roƒçne",icon:"üìÜ"},{value:"yearly",label:"Roƒçne",icon:"üóìÔ∏è"}],Mt=({open:p,onClose:D,onExpensesChanged:E})=>{const{getFilteredVehicles:I}=_e(),A=I(),[F,N]=d.useState([]),[O,P]=d.useState([]),[m,j]=d.useState(!1),[u,f]=d.useState(!1),[g,T]=d.useState(null),[n,x]=d.useState(null),[L,R]=d.useState(null),[o,v]=d.useState({name:"",description:"",amount:0,category:"",company:"",vehicleId:"",note:"",frequency:"monthly",startDate:new Date().toISOString().split("T")[0],endDate:"",dayOfMonth:1,isActive:!0}),_=async()=>{j(!0),x(null);try{const[t,l]=await Promise.all([M.getRecurringExpenses(),M.getExpenseCategories()]);N(t),P(l)}catch(t){x("Chyba pri naƒç√≠tavan√≠ d√°t: "+t.message)}finally{j(!1)}};d.useEffect(()=>{p&&_()},[p]);const Y=()=>{v({name:"",description:"",amount:0,category:O.length>0?O[0].name:"",company:"",vehicleId:"",note:"",frequency:"monthly",startDate:new Date().toISOString().split("T")[0],endDate:"",dayOfMonth:1,isActive:!0}),T(null)},ne=()=>{Y(),f(!0)},r=t=>{const l=(()=>{try{const z=typeof t.startDate=="string"?new Date(t.startDate):t.startDate;return isNaN(z.getTime())?new Date().toISOString().split("T")[0]:z.toISOString().split("T")[0]}catch{return new Date().toISOString().split("T")[0]}})(),K=(()=>{if(!t.endDate)return"";try{const z=typeof t.endDate=="string"?new Date(t.endDate):t.endDate;return isNaN(z.getTime())?"":z.toISOString().split("T")[0]}catch{return""}})();v({name:t.name,description:t.description,amount:t.amount,category:t.category,company:t.company,vehicleId:t.vehicleId||"",note:t.note||"",frequency:t.frequency,startDate:l,endDate:K,dayOfMonth:t.dayOfMonth,isActive:t.isActive}),T(t),f(!0)},C=async t=>{if(window.confirm(`Naozaj chcete zmaza≈• pravideln√Ω n√°klad "${t.name}"?

Toto neovplyvn√≠ u≈æ vygenerovan√© n√°klady.`)){j(!0),x(null);try{await M.deleteRecurringExpense(t.id),R("Pravideln√Ω n√°klad √∫spe≈°ne zmazan√Ω"),await _()}catch(l){x("Chyba pri mazan√≠: "+l.message)}finally{j(!1)}}},xe=async t=>{if(window.confirm(`Vygenerova≈• n√°klad "${t.name}" pre aktu√°lny mesiac?`)){j(!0),x(null);try{await M.generateSingleRecurringExpense(t.id),R("N√°klad √∫spe≈°ne vygenerovan√Ω"),await _(),E?.()}catch(l){x("Chyba pri generovan√≠: "+l.message)}finally{j(!1)}}},Ie=async()=>{if(window.confirm("Vygenerova≈• v≈°etky splatn√© pravideln√© n√°klady?")){j(!0),x(null);try{const t=await M.generateRecurringExpenses();R(`Generovanie dokonƒçen√©: ${t.generated} vytvoren√Ωch, ${t.skipped} preskoƒçen√Ωch`),await _(),E?.()}catch(t){x("Chyba pri generovan√≠: "+t.message)}finally{j(!1)}}},he=async()=>{if(!o.name.trim()||!o.description.trim()||!o.category||!o.company.trim()){x("Vypl≈àte v≈°etky povinn√© polia");return}if(o.amount<=0){x("Suma mus√≠ by≈• v√§ƒç≈°ia ako 0");return}j(!0),x(null);try{if(g){const t={...g,name:o.name.trim(),description:o.description.trim(),amount:o.amount,category:o.category,company:o.company.trim(),vehicleId:o.vehicleId||void 0,note:o.note.trim()||void 0,frequency:o.frequency,startDate:new Date(o.startDate),endDate:o.endDate?new Date(o.endDate):void 0,dayOfMonth:o.dayOfMonth,isActive:o.isActive,updatedAt:new Date};await M.updateRecurringExpense(t),R("Pravideln√Ω n√°klad √∫spe≈°ne aktualizovan√Ω")}else await M.createRecurringExpense({name:o.name.trim(),description:o.description.trim(),amount:o.amount,category:o.category,company:o.company.trim(),vehicleId:o.vehicleId||void 0,note:o.note.trim()||void 0,frequency:o.frequency,startDate:new Date(o.startDate),endDate:o.endDate?new Date(o.endDate):void 0,dayOfMonth:o.dayOfMonth}),R("Pravideln√Ω n√°klad √∫spe≈°ne vytvoren√Ω");f(!1),await _()}catch(t){x("Chyba pri ukladan√≠: "+t.message)}finally{j(!1)}},w=()=>{f(!1),Y(),x(null)},we=t=>Je.find(K=>K.value===t)?.label||t,ze=t=>{if(!t||t===null)return"Nie je nastaven√©";let l;try{if(l=typeof t=="string"?new Date(t):t,isNaN(l.getTime()))throw new Error("Invalid date")}catch{return console.warn("Invalid date received:",t),"Neplatn√Ω d√°tum"}const z=l<new Date;return e.jsxs("span",{style:{color:z?"#d32f2f":"#1976d2",fontWeight:z?600:400},children:[Se(l,"dd.MM.yyyy",{locale:Qe}),z&&" (splatn√©)"]})};return e.jsxs(ce,{open:p,onClose:D,maxWidth:"lg",fullWidth:!0,children:[e.jsxs(fe,{sx:{display:"flex",alignItems:"center",gap:1,backgroundColor:"#f5f5f5",borderBottom:"1px solid #e0e0e0"},children:[e.jsx(Re,{sx:{color:"#1976d2"}}),"Pravideln√© mesaƒçn√© n√°klady"]}),e.jsxs(ve,{sx:{p:3},children:[n&&e.jsx(ge,{severity:"error",sx:{mb:2},onClose:()=>x(null),children:n}),L&&e.jsx(ge,{severity:"success",sx:{mb:2},onClose:()=>R(null),children:L}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2},children:[e.jsxs(i,{variant:"h6",sx:{fontWeight:600},children:["Pravideln√© n√°klady (",F.length,")"]}),e.jsxs(s,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(b,{variant:"outlined",startIcon:e.jsx(Ye,{}),onClick:Ie,disabled:m,sx:{borderColor:"#4caf50",color:"#4caf50","&:hover":{borderColor:"#388e3c",bgcolor:"rgba(76, 175, 80, 0.04)"}},children:"Vygenerova≈• v≈°etky splatn√©"}),e.jsx(b,{variant:"contained",startIcon:e.jsx(qe,{}),onClick:ne,disabled:m,children:"Prida≈• pravideln√Ω n√°klad"})]})]}),m&&e.jsx(s,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx($e,{})}),e.jsx(H,{sx:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(et,{children:[F.map((t,l)=>{const K=O.find(B=>B.name===t.category),z=t.vehicleId?A.find(B=>B.id===t.vehicleId):null,oe=t.nextGenerationDate&&t.nextGenerationDate<new Date;return e.jsxs(tt.Fragment,{children:[e.jsxs(ye,{sx:{py:2,backgroundColor:oe?"#fff3e0":"transparent","&:hover":{backgroundColor:oe?"#ffe0b2":"#f5f5f5"}},children:[e.jsx(je,{primary:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600},children:t.name}),e.jsx(X,{label:K?.displayName||t.category,color:K?.color||"primary",size:"small",sx:{fontWeight:600}}),e.jsx(X,{label:we(t.frequency),variant:"outlined",size:"small"}),!t.isActive&&e.jsx(X,{label:"Neakt√≠vny",color:"error",variant:"outlined",size:"small"})]}),secondary:e.jsxs(s,{sx:{mt:1},children:[e.jsx(i,{variant:"body1",sx:{mb:1,fontWeight:500},children:t.description}),e.jsxs(c,{container:!0,spacing:2,sx:{fontSize:"0.875rem"},children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(ot,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsxs(i,{variant:"body2",sx:{fontWeight:600,color:"#1976d2"},children:[t.amount.toFixed(2),"‚Ç¨"]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(lt,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:t.company})]})}),z&&e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(rt,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:[z.brand," ",z.model]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(bt,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["ƒéal≈°√≠: ",ze(t.nextGenerationDate)]})]})})]}),t.note&&e.jsx(i,{variant:"body2",sx:{mt:1,fontStyle:"italic",color:"text.secondary",p:1,backgroundColor:"#f5f5f5",borderRadius:1},children:t.note}),e.jsxs(s,{sx:{mt:1,display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Vygenerovan√©: ",t.totalGenerated,"x"]}),t.lastGeneratedDate&&e.jsxs(i,{variant:"caption",color:"text.secondary",children:["| Posledn√Ω: ",(()=>{try{const B=typeof t.lastGeneratedDate=="string"?new Date(t.lastGeneratedDate):t.lastGeneratedDate;return isNaN(B.getTime())?"Neplatn√Ω d√°tum":Se(B,"dd.MM.yyyy",{locale:Qe})}catch{return"Neplatn√Ω d√°tum"}})()]}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["| Ka≈æd√Ω ",t.dayOfMonth,". de≈à v mesiaci"]})]})]})}),e.jsx(at,{children:e.jsxs(s,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:[t.isActive&&e.jsx(ie,{title:"Vygenerova≈• teraz",children:e.jsx(Q,{size:"small",onClick:()=>xe(t),disabled:m,sx:{backgroundColor:"#e8f5e8",color:"#4caf50","&:hover":{backgroundColor:"#c8e6c9"}},children:e.jsx(Ye,{fontSize:"small"})})}),e.jsx(ie,{title:"Upravi≈•",children:e.jsx(Q,{size:"small",onClick:()=>r(t),disabled:m,sx:{backgroundColor:"#f5f5f5","&:hover":{backgroundColor:"#e0e0e0"}},children:e.jsx(be,{fontSize:"small"})})}),e.jsx(ie,{title:"Zmaza≈•",children:e.jsx(Q,{size:"small",onClick:()=>C(t),disabled:m,sx:{backgroundColor:"#ffebee",color:"#d32f2f","&:hover":{backgroundColor:"#ffcdd2"}},children:e.jsx(Ce,{fontSize:"small"})})})]})})]}),l<F.length-1&&e.jsx(Ge,{})]},t.id)}),F.length===0&&!m&&e.jsx(ye,{children:e.jsx(je,{primary:e.jsx(i,{variant:"body1",color:"text.secondary",sx:{textAlign:"center",py:4},children:"≈Ωiadne pravideln√© n√°klady nen√°jden√©"})})})]})})]}),e.jsx(ke,{sx:{p:3,backgroundColor:"#f5f5f5"},children:e.jsx(b,{onClick:D,variant:"outlined",children:"Zavrie≈•"})}),e.jsxs(ce,{open:u,onClose:w,maxWidth:"md",fullWidth:!0,children:[e.jsxs(fe,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Re,{}),g?"Upravi≈• pravideln√Ω n√°klad":"Prida≈• pravideln√Ω n√°klad"]}),e.jsx(ve,{sx:{pt:2},children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,label:"N√°zov *",value:o.name,onChange:t=>v(l=>({...l,name:t.target.value})),required:!0,helperText:"N√°zov pre identifik√°ciu (napr. 'Poistenie BMW X5')"})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,label:"Suma (‚Ç¨) *",type:"number",value:o.amount||"",onChange:t=>v(l=>({...l,amount:parseFloat(t.target.value)||0})),required:!0,inputProps:{min:0,step:.01}})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Popis n√°kladu *",value:o.description,onChange:t=>v(l=>({...l,description:t.target.value})),required:!0,helperText:"Tento text sa pou≈æije v generovan√Ωch n√°kladoch"})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsxs($,{fullWidth:!0,required:!0,children:[e.jsx(G,{children:"Kateg√≥ria"}),e.jsx(Z,{value:o.category,onChange:t=>v(l=>({...l,category:t.target.value})),label:"Kateg√≥ria",children:O.map(t=>e.jsx(y,{value:t.name,children:t.displayName},t.name))})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(S,{fullWidth:!0,label:"Firma *",value:o.company,onChange:t=>v(l=>({...l,company:t.target.value})),required:!0})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Vozidlo"}),e.jsxs(Z,{value:o.vehicleId,onChange:t=>v(l=>({...l,vehicleId:t.target.value})),label:"Vozidlo",children:[e.jsx(y,{value:"",children:"Bez vozidla"}),A.map(t=>e.jsxs(y,{value:t.id,children:[t.brand," ",t.model," - ",t.licensePlate]},t.id))]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsxs($,{fullWidth:!0,required:!0,children:[e.jsx(G,{children:"Frekvencia"}),e.jsx(Z,{value:o.frequency,onChange:t=>v(l=>({...l,frequency:t.target.value})),label:"Frekvencia",children:Je.map(t=>e.jsx(y,{value:t.value,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:t.icon}),t.label]})},t.value))})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(S,{fullWidth:!0,label:"Zaƒçiatok platnosti",type:"date",value:o.startDate,onChange:t=>v(l=>({...l,startDate:t.target.value})),InputLabelProps:{shrink:!0},required:!0})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(S,{fullWidth:!0,label:"Koniec platnosti",type:"date",value:o.endDate,onChange:t=>v(l=>({...l,endDate:t.target.value})),InputLabelProps:{shrink:!0},helperText:"Voliteƒæn√© - nechajte pr√°zdne pre nekoneƒçne"})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,label:"De≈à v mesiaci",type:"number",value:o.dayOfMonth,onChange:t=>v(l=>({...l,dayOfMonth:parseInt(t.target.value)||1})),inputProps:{min:1,max:28},helperText:"De≈à kedy sa m√° vygenerova≈• n√°klad (1-28)",required:!0})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(vt,{control:e.jsx(Ct,{checked:o.isActive,onChange:t=>v(l=>({...l,isActive:t.target.checked}))}),label:"Akt√≠vny"})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"Pozn√°mka",value:o.note,onChange:t=>v(l=>({...l,note:t.target.value})),multiline:!0,rows:2,helperText:"Voliteƒæn√° pozn√°mka pre generovan√© n√°klady"})})]})}),e.jsxs(ke,{sx:{p:3,gap:1},children:[e.jsx(b,{onClick:w,variant:"outlined",startIcon:e.jsx(st,{}),children:"Zru≈°i≈•"}),e.jsx(b,{onClick:he,variant:"contained",startIcon:e.jsx(nt,{}),disabled:m||!o.name.trim()||!o.description.trim()||!o.category||!o.company.trim()||o.amount<=0,children:g?"Aktualizova≈•":"Vytvori≈•"})]})]})]})},pe=(p,D)=>{const E=D.find(A=>A.name===p);return E?{local_gas_station:e.jsx(Nt,{fontSize:"small"}),build:e.jsx(Wt,{fontSize:"small"}),security:e.jsx(Dt,{fontSize:"small"}),category:e.jsx(Le,{fontSize:"small"}),receipt:e.jsx(ae,{fontSize:"small"})}[E.icon]||e.jsx(ae,{fontSize:"small"}):e.jsx(ae,{fontSize:"small"})},Te=(p,D)=>D.find(I=>I.name===p)?.displayName||p,Xe=(p,D)=>D.find(I=>I.name===p)?.color||"primary",ea=()=>{const{getFilteredExpenses:p,getFilteredVehicles:D,deleteExpense:E,createExpense:I,updateExpense:A}=_e(),F=gt(),N=yt(F.breakpoints.down("md"),{noSsr:!0}),O=p(),P=D(),[m,j]=d.useState(""),[u,f]=d.useState("all"),[g,T]=d.useState(""),[n,x]=d.useState(""),[L,R]=d.useState(!1),[o,v]=d.useState(!1),[_,Y]=d.useState(null),[ne,r]=d.useState(!1),[C,xe]=d.useState(!1),[Ie,he]=d.useState(!1),[w,we]=d.useState([]),ze=d.useMemo(()=>Array.from(new Set(O.map(a=>a.company).filter(Boolean))).sort(),[O]),t=async()=>{try{const a=await M.getExpenseCategories();we(a)}catch(a){console.error("Error loading expense categories:",a)}};d.useEffect(()=>{t()},[]);const l=d.useMemo(()=>O.filter(a=>{const h=!m||a.description.toLowerCase().includes(m.toLowerCase())||a.note?.toLowerCase().includes(m.toLowerCase())||a.company.toLowerCase().includes(m.toLowerCase()),W=u==="all"||a.category===u,q=!g||a.company===g,re=!n||a.vehicleId===n;return h&&W&&q&&re}),[O,m,u,g,n]),K=d.useMemo(()=>l.reduce((a,h)=>a+h.amount,0),[l]),z=d.useMemo(()=>{const a={};return w.forEach(h=>{a[h.name]=0}),l.forEach(h=>{a[h.category]!==void 0&&(a[h.category]+=h.amount)}),a},[l,w]),oe=()=>{Y(null),v(!0)},B=a=>{Y(a),v(!0)},Ze=async a=>{if(window.confirm(`Naozaj chcete zmaza≈• n√°klad "${a.description}"?`)){r(!0);try{await E(a.id)}catch(h){console.error("Error deleting expense:",h)}finally{r(!1)}}},it=async a=>{r(!0);try{_&&a.id?await A({..._,...a}):await I(a),v(!1),Y(null)}catch(h){console.error("Error saving expense:",h)}finally{r(!1)}},ct=async()=>{try{const{apiService:a}=await jt(async()=>{const{apiService:q}=await import("./index-DfP_Aygt.js").then(re=>re.bQ);return{apiService:q}},__vite__mapDeps([0,1])),h=await a.exportExpensesCSV(),W=`naklady-${new Date().toISOString().split("T")[0]}.csv`;kt.saveAs(h,W),alert("CSV export √∫spe≈°n√Ω")}catch(a){console.error("CSV export error:",a),alert("Chyba pri CSV exporte")}},dt=a=>{const h=a.target.files?.[0];h&&(St.parse(h,{complete:async W=>{try{if(!W.data||W.data.length<2){alert("CSV s√∫bor mus√≠ obsahova≈• aspo≈à hlaviƒçku a jeden riadok d√°t");return}const q=W.data[0],re=W.data.slice(1),Be=[],U=ee=>{for(const V of ee){const Fe=q.findIndex(se=>se&&se.toString().toLowerCase().trim()===V.toLowerCase());if(Fe!==-1)return Fe}return-1},k={id:U(["id","ID"]),description:U(["description","popis","Description","Popis"]),amount:U(["amount","suma","Amount","Suma","cena","Cena"]),date:U(["date","datum","Date","D√°tum"]),category:U(["category","kategoria","Category","Kateg√≥ria"]),company:U(["company","firma","Company","Firma"]),vehicleId:U(["vehicleId","vehicle_id","vozidlo_id"]),vehicleLicensePlate:U(["vehicleLicensePlate","spz","SPZ","license_plate"]),note:U(["note","poznamka","Note","Pozn√°mka"])};for(let ee=0;ee<re.length;ee++){const V=re[ee];if(!V||V.length===0||!V.some(J=>J&&J.toString().trim()))continue;const Fe=k.id>=0?V[k.id]:void 0,se=k.description>=0?V[k.description]:void 0,me=k.amount>=0?V[k.amount]:void 0,Ne=k.date>=0?V[k.date]:void 0,Pe=k.category>=0?V[k.category]:void 0,Ve=k.company>=0?V[k.company]:void 0,Ae=k.vehicleId>=0?V[k.vehicleId]:void 0,Tt=k.vehicleLicensePlate>=0?V[k.vehicleLicensePlate]:void 0,Oe=k.note>=0?V[k.note]:void 0;if(!se||se.toString().trim()===""){console.warn(`Riadok ${ee+2}: Preskakujem - ch√Ωba popis`);continue}let ue=0;me&&me.toString().trim()!==""&&(ue=parseFloat(me.toString().replace(",",".")),isNaN(ue)&&(console.warn(`Riadok ${ee+2}: Neplatn√° suma "${me}", nastavujem na 0`),ue=0));let Me=new Date;if(Ne&&Ne.toString().trim()){const J=Ne.toString().trim();if(/^\d{1,2}\/\d{4}$/.test(J)){const[le,ft]=J.split("/");Me=new Date(parseInt(ft),parseInt(le)-1,1)}else{const le=new Date(J);isNaN(le.getTime())||(Me=le)}}let Ke="other";if(Pe&&Pe.toString().trim()){const J=Pe.toString().toLowerCase().trim();Ke={fuel:"fuel",palivo:"fuel",benz√≠n:"fuel",nafta:"fuel",service:"service",servis:"service",oprava:"service",√∫dr≈æba:"service",insurance:"insurance",poistenie:"insurance",other:"other",ostatn√©:"other",in√©:"other"}[J]||"other"}const pt={id:"",description:se.toString().trim(),amount:ue,date:Me,category:Ke,vehicleId:Ae&&Ae.toString().trim()!==""?Ae.toString().trim():void 0,company:Ve&&Ve.toString().trim()!==""?Ve.toString().trim():"Black Holding",note:Oe&&Oe.toString().trim()!==""?Oe.toString().trim():void 0};Be.push(pt)}const ht=await M.batchImportExpenses(Be),{created:De,updated:We,errorsCount:Ee,successRate:He,processed:mt,total:ut}=ht;De>0||We>0?(alert(`üöÄ BATCH IMPORT √öSPE≈†N√ù!

üìä V√Ωsledky:
‚Ä¢ Vytvoren√Ωch: ${De}
‚Ä¢ Aktualizovan√Ωch: ${We}
‚Ä¢ Spracovan√Ωch: ${mt}/${ut}
‚Ä¢ Ch√Ωb: ${Ee}
‚Ä¢ √öspe≈°nos≈•: ${He}

Str√°nka sa obnov√≠ za 3 sekundy...`),setTimeout(()=>window.location.reload(),3e3)):Ee>0?alert(`‚ö†Ô∏è Import dokonƒçen√Ω, ale ≈æiadne n√°klady neboli pridan√©.

üìä V√Ωsledky:
‚Ä¢ Vytvoren√Ωch: ${De}
‚Ä¢ Aktualizovan√Ωch: ${We}
‚Ä¢ Ch√Ωb: ${Ee}
‚Ä¢ √öspe≈°nos≈•: ${He}

Skontrolujte form√°t CSV s√∫boru.`):alert(`‚ö†Ô∏è Import dokonƒçen√Ω, ale ≈æiadne n√°klady neboli pridan√©.
Skontrolujte form√°t CSV s√∫boru.`)}catch(q){console.error("‚ùå CSV import error:",q),alert(`‚ö†Ô∏è Import dokonƒçen√Ω s upozornen√≠m: ${q instanceof Error?q.message:"Sie≈•ov√° chyba"}

Skontrolujte v√Ωsledok po obnoven√≠ str√°nky.`),setTimeout(()=>window.location.reload(),2e3)}},header:!1,skipEmptyLines:!0}),a.target.value="")},xt=()=>{j(""),f("all"),T(""),x("")};return e.jsxs(s,{sx:{p:{xs:1,md:3}},children:[e.jsx(H,{sx:{mb:3,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:e.jsx(te,{children:e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ae,{sx:{color:"#1976d2",fontSize:28}}),e.jsx(i,{variant:"h4",sx:{fontWeight:700,color:"#1976d2"},children:"N√°klady"})]}),e.jsxs(s,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(b,{variant:"contained",startIcon:e.jsx(qe,{}),onClick:oe,sx:{minWidth:120},children:"Prida≈•"}),e.jsx(b,{variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>he(!0),sx:{borderColor:"#4caf50",color:"#4caf50","&:hover":{borderColor:"#388e3c",bgcolor:"rgba(76, 175, 80, 0.04)"}},children:"Pravideln√© n√°klady"}),e.jsx(b,{variant:"outlined",startIcon:e.jsx(It,{}),onClick:()=>xe(!0),sx:{borderColor:"#1976d2",color:"#1976d2","&:hover":{borderColor:"#1565c0",bgcolor:"rgba(25, 118, 210, 0.04)"}},children:"Spravova≈• kateg√≥rie"}),!N&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outlined",onClick:ct,disabled:l.length===0,children:"üìä Export CSV"}),e.jsxs(b,{variant:"outlined",component:"label",sx:{borderColor:"#1976d2",color:"#1976d2","&:hover":{borderColor:"#1565c0",bgcolor:"rgba(25, 118, 210, 0.04)"}},children:["üì• Import CSV",e.jsx("input",{type:"file",accept:".csv",onChange:dt,style:{display:"none"}})]})]})]})]})})}),e.jsx(H,{sx:{mb:3,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(te,{children:[e.jsxs(s,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(S,{placeholder:"Hƒæada≈• n√°klady...",value:m,onChange:a=>j(a.target.value),InputProps:{startAdornment:e.jsx(wt,{sx:{color:"text.secondary",mr:1}})},sx:{minWidth:250,flexGrow:1}}),e.jsx(b,{variant:L?"contained":"outlined",startIcon:e.jsx(zt,{}),onClick:()=>R(!L),children:"Filtre"}),(u!=="all"||g||n)&&e.jsx(b,{variant:"text",onClick:xt,children:"Vymaza≈• filtre"})]}),L&&e.jsx(s,{sx:{mt:2,pt:2,borderTop:"1px solid #e0e0e0"},children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Kateg√≥ria"}),e.jsxs(Z,{value:u,onChange:a=>f(a.target.value),label:"Kateg√≥ria",children:[e.jsx(y,{value:"all",children:"V≈°etky kateg√≥rie"}),w.map(a=>e.jsx(y,{value:a.name,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[pe(a.name,w),Te(a.name,w)]})},a.name))]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Firma"}),e.jsxs(Z,{value:g,onChange:a=>T(a.target.value),label:"Firma",children:[e.jsx(y,{value:"",children:"V≈°etky firmy"}),ze.map(a=>e.jsx(y,{value:a,children:a},a))]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(G,{children:"Vozidlo"}),e.jsxs(Z,{value:n,onChange:a=>x(a.target.value),label:"Vozidlo",children:[e.jsx(y,{value:"",children:"V≈°etky vozidl√°"}),P.map(a=>e.jsxs(y,{value:a.id,children:[a.brand," ",a.model," - ",a.licensePlate]},a.id))]})]})})]})})]})}),e.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:e.jsx(te,{children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600},children:"Celkom"}),e.jsx(i,{variant:"h4",sx:{fontWeight:700},children:l.length})]}),e.jsx(ae,{sx:{fontSize:40,opacity:.8}})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{sx:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:e.jsx(te,{children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600},children:"Suma"}),e.jsxs(i,{variant:"h4",sx:{fontWeight:700},children:[K.toFixed(2),"‚Ç¨"]})]}),e.jsx(ot,{sx:{fontSize:40,opacity:.8}})]})})})}),w.slice(0,2).map((a,h)=>e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{sx:{background:h===0?"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)":"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",color:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:e.jsx(te,{children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600},children:a.displayName}),e.jsxs(i,{variant:"h4",sx:{fontWeight:700},children:[(z[a.name]||0).toFixed(2),"‚Ç¨"]})]}),pe(a.name,w)]})})})},a.name))]}),ne&&e.jsx(s,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx($e,{})}),N?e.jsx(s,{sx:{display:"flex",flexDirection:"column",gap:1},children:l.length===0?e.jsx(H,{sx:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(te,{sx:{textAlign:"center",py:4},children:[e.jsx(ae,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(i,{variant:"h6",color:"text.secondary",children:"≈Ωiadne n√°klady nen√°jden√©"})]})}):l.map(a=>{const h=a.vehicleId?P.find(W=>W.id===a.vehicleId):null;return e.jsx(H,{sx:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:2,"&:hover":{boxShadow:"0 4px 16px rgba(0,0,0,0.15)",transform:"translateY(-2px)"},transition:"all 0.2s ease"},children:e.jsxs(te,{sx:{p:2},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(s,{sx:{flexGrow:1,mr:2},children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600,mb:.5,wordWrap:"break-word"},children:a.description}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(X,{icon:pe(a.category,w),label:Te(a.category,w),color:Xe(a.category,w),size:"small",sx:{fontWeight:600}}),e.jsxs(i,{variant:"h6",sx:{fontWeight:700,color:"#1976d2"},children:[a.amount.toFixed(2),"‚Ç¨"]})]})]}),e.jsxs(s,{sx:{display:"flex",gap:.5},children:[e.jsx(Q,{size:"small",onClick:()=>B(a),sx:{backgroundColor:"#f5f5f5","&:hover":{backgroundColor:"#e0e0e0"}},children:e.jsx(be,{fontSize:"small"})}),e.jsx(Q,{size:"small",onClick:()=>Ze(a),sx:{backgroundColor:"#ffebee",color:"#d32f2f","&:hover":{backgroundColor:"#ffcdd2"}},children:e.jsx(Ce,{fontSize:"small"})})]})]}),e.jsx(Ge,{sx:{my:1}}),e.jsxs(c,{container:!0,spacing:1,sx:{fontSize:"0.875rem"},children:[e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Et,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:Se(new Date(a.date),"dd.MM.yyyy")})]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(lt,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsx(i,{variant:"body2",color:"text.secondary",noWrap:!0,children:a.company})]})}),h&&e.jsx(c,{item:!0,xs:12,children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(rt,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:[h.brand," ",h.model," - ",h.licensePlate]})]})}),a.note&&e.jsx(c,{item:!0,xs:12,children:e.jsx(i,{variant:"body2",sx:{fontStyle:"italic",color:"text.secondary",mt:1,p:1,backgroundColor:"#f5f5f5",borderRadius:1},children:a.note})})]})]})},a.id)})}):e.jsxs(H,{sx:{boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[e.jsx(s,{sx:{position:"sticky",top:0,backgroundColor:"white",zIndex:1,borderBottom:"2px solid #f0f0f0"},children:e.jsxs(s,{sx:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr 120px",gap:2,p:2,fontWeight:600,color:"#1976d2",backgroundColor:"#f8f9fa"},children:[e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700},children:"Popis"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700},children:"Kateg√≥ria"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700},children:"Suma"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700},children:"D√°tum"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700},children:"Firma"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700},children:"Vozidlo"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700,textAlign:"center"},children:"Akcie"})]})}),e.jsx(s,{sx:{maxHeight:"600px",overflow:"auto"},children:l.length===0?e.jsxs(s,{sx:{textAlign:"center",py:8},children:[e.jsx(ae,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(i,{variant:"h6",color:"text.secondary",children:"≈Ωiadne n√°klady nen√°jden√©"})]}):l.map((a,h)=>{const W=a.vehicleId?P.find(q=>q.id===a.vehicleId):null;return e.jsxs(s,{sx:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr 120px",gap:2,p:2,borderBottom:"1px solid #e0e0e0",backgroundColor:h%2===0?"#fafafa":"white","&:hover":{backgroundColor:"#f0f7ff",cursor:"pointer"},transition:"background-color 0.2s ease"},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"body1",sx:{fontWeight:600,mb:.5},children:a.description}),a.note&&e.jsx(i,{variant:"body2",sx:{color:"text.secondary",fontStyle:"italic"},children:a.note})]}),e.jsx(s,{sx:{display:"flex",alignItems:"center"},children:e.jsx(X,{icon:pe(a.category,w),label:Te(a.category,w),color:Xe(a.category,w),size:"small",sx:{fontWeight:600}})}),e.jsxs(i,{variant:"body1",sx:{fontWeight:700,color:"#1976d2",display:"flex",alignItems:"center"},children:[a.amount.toFixed(2),"‚Ç¨"]}),e.jsx(i,{variant:"body2",sx:{display:"flex",alignItems:"center"},children:Se(new Date(a.date),"dd.MM.yyyy")}),e.jsx(i,{variant:"body2",sx:{display:"flex",alignItems:"center"},noWrap:!0,children:a.company}),e.jsx(i,{variant:"body2",sx:{display:"flex",alignItems:"center"},noWrap:!0,children:W?`${W.brand} ${W.model} - ${W.licensePlate}`:"-"}),e.jsxs(s,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[e.jsx(ie,{title:"Upravi≈•",children:e.jsx(Q,{size:"small",onClick:()=>B(a),sx:{backgroundColor:"#f5f5f5","&:hover":{backgroundColor:"#e0e0e0"}},children:e.jsx(be,{fontSize:"small"})})}),e.jsx(ie,{title:"Zmaza≈•",children:e.jsx(Q,{size:"small",onClick:()=>Ze(a),sx:{backgroundColor:"#ffebee",color:"#d32f2f","&:hover":{backgroundColor:"#ffcdd2"}},children:e.jsx(Ce,{fontSize:"small"})})})]})]},a.id)})})]}),e.jsx(ce,{open:o,onClose:()=>v(!1),maxWidth:"md",fullWidth:!0,fullScreen:N,children:e.jsx(Pt,{expense:_,onSave:it,onCancel:()=>v(!1),categories:w})}),e.jsx(Ot,{open:C,onClose:()=>xe(!1),onCategoriesChanged:t}),e.jsx(Mt,{open:Ie,onClose:()=>he(!1),onExpensesChanged:()=>{window.location.reload()}})]})};export{ea as default};
