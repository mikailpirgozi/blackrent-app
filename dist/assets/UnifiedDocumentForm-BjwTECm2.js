import{c as pe,j as e,a as v,B as p,x as he,ad as me,Q as $,T as d,aV as xe,aD as ve,G as ye,v as se,an as W,ao as U,w as O,a6 as fe,C as _,$ as F,q as C,M as te,N as re,O as ae,P as x,o as ne,a0 as je,t as G}from"./index-DfP_Aygt.js";import{r as Z}from"./createSvgIcon-CNgCHA2Q.js";import{V as ge}from"./Visibility-PIDOLgzl.js";import{G as o}from"./Grid-Bdewy4dZ.js";import{A as ke}from"./Autocomplete-BMd06Jll.js";import{D as Y}from"./DatePicker-oDpvhgCb.js";const be=pe(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),Pe=({type:s,entityId:m,mediaType:h,onUploadSuccess:b,onUploadError:K,acceptedTypes:w=["image/jpeg","image/png","image/webp","application/pdf"],maxSize:r=10,multiple:l=!1,label:Q="Nahra≈• s√∫bor",disabled:P=!1,showUploadedFiles:I=!0})=>{const[k,u]=v.useState(!1),[H,M]=v.useState([]),[L,q]=v.useState(null),z=v.useRef(null),j=async t=>new Promise(a=>{const i=document.createElement("canvas"),n=i.getContext("2d"),c=new Image;c.onload=()=>{let{width:y,height:f}=c;y>1920&&(f=f*1920/y,y=1920),f>1080&&(y=y*1080/f,f=1080),i.width=y,i.height=f,n?.drawImage(c,0,0,y,f),i.toBlob(T=>{if(T){const ue=new File([T],t.name,{type:"image/jpeg",lastModified:Date.now()});a(ue)}else a(t)},"image/jpeg",.8)},c.onerror=()=>{a(t)},c.src=URL.createObjectURL(t)}),g=async t=>{const a=t.target.files;if(!(!a||a.length===0)){q(null),u(!0);try{const i=Array.from(a).map(async c=>{if(!w.includes(c.type))throw new Error(`Nepodporovan√Ω typ s√∫boru: ${c.type}`);if(c.size>r*1024*1024)throw new Error(`S√∫bor je pr√≠li≈° veƒæk√Ω. Maximum: ${r}MB`);let D=c;c.type.startsWith("image/")&&(D=await j(c));const S=new FormData;S.append("file",D),S.append("type",s),S.append("entityId",m),h&&S.append("mediaType",h);const y=localStorage.getItem("blackrent_token")||sessionStorage.getItem("blackrent_token"),f=await fetch(`${se()}/files/upload`,{method:"POST",headers:{...y&&{Authorization:`Bearer ${y}`}},body:S}),T=await f.json();if(!f.ok||!T.success)throw new Error(T.error||"Upload zlyhal");return T}),n=await Promise.all(i);M(l?c=>[...c,...n]:n),b&&b(l?n:n[0])}catch(i){const n=i instanceof Error?i.message:"Upload zlyhal";console.error("üîç R2 UPLOAD ERROR:",n),q(n),K?.(n)}finally{u(!1),z.current&&(z.current.value="")}}},X=async t=>{try{const a=localStorage.getItem("blackrent_token")||sessionStorage.getItem("blackrent_token");if(!(await fetch(`${se()}/files/${encodeURIComponent(t)}`,{method:"DELETE",headers:{...a&&{Authorization:`Bearer ${a}`}}})).ok)throw new Error("Chyba pri mazan√≠ s√∫boru");M(n=>n.filter(c=>c.key!==t))}catch{q("Chyba pri mazan√≠ s√∫boru")}},B=t=>{if(t===0)return"0 Bytes";const a=1024,i=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,n)).toFixed(2))+" "+i[n]},ee=t=>t.startsWith("image/")?"üñºÔ∏è":t==="application/pdf"?"üìÑ":"üìé";return e.jsxs(p,{sx:{width:"100%"},children:[e.jsxs(p,{sx:{mb:2},children:[e.jsx("input",{ref:z,type:"file",multiple:l,accept:w.join(","),onChange:g,style:{display:"none"},disabled:P||k}),e.jsx(he,{startIcon:k?e.jsx(me,{size:20}):e.jsx(be,{}),onClick:()=>z.current?.click(),disabled:P||k,fullWidth:!0,sx:{py:2,borderStyle:"dashed",borderWidth:2,"&:hover":{borderWidth:2,backgroundColor:"rgba(25, 118, 210, 0.04)"}},children:k?"Nahr√°vam...":Q})]}),L&&e.jsx($,{severity:"error",sx:{mb:2},children:L}),H.length>0&&e.jsxs(p,{sx:{mt:2},children:[e.jsx(d,{variant:"subtitle2",sx:{mb:1,color:"white"},children:"Nahran√© s√∫bory:"}),H.map((t,a)=>e.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,mb:1,border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:1,backgroundColor:"rgba(255, 255, 255, 0.05)"},children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:ee(t.mimetype)}),e.jsxs(p,{children:[e.jsx(d,{variant:"body2",sx:{color:"white"},children:t.filename}),e.jsx(d,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.7)"},children:B(t.size)})]})]}),e.jsxs(p,{sx:{display:"flex",gap:1},children:[e.jsx(xe,{size:"small",startIcon:e.jsx(ge,{}),onClick:()=>window.open(t.url,"_blank"),sx:{color:"white"},children:"Zobrazi≈•"}),e.jsx(ve,{size:"small",startIcon:e.jsx(ye,{}),onClick:()=>X(t.key),children:"Zmaza≈•"})]})]},t.key))]}),e.jsxs(p,{sx:{mt:1},children:[e.jsxs(d,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.7)"},children:["Podporovan√© typy: ",w.map(t=>t.startsWith("image/")?"Obr√°zky":t==="application/pdf"?"PDF":t).join(", ")]}),e.jsxs(d,{variant:"caption",sx:{display:"block",color:"rgba(255, 255, 255, 0.7)"},children:["Max veƒækos≈•: ",r,"MB"]})]})]})};var V={},ie;function _e(){if(ie)return V;ie=1;var s=W();Object.defineProperty(V,"__esModule",{value:!0}),V.default=void 0;var m=s(Z()),h=U();return V.default=(0,m.default)((0,h.jsx)("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"Security"),V}var Fe=_e();const J=O(Fe);var A={},oe;function Ce(){if(oe)return A;oe=1;var s=W();Object.defineProperty(A,"__esModule",{value:!0}),A.default=void 0;var m=s(Z()),h=U();return A.default=(0,m.default)((0,h.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"}),"Build"),A}var we=Ce();const Ie=O(we);var E={},le;function ze(){if(le)return E;le=1;var s=W();Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var m=s(Z()),h=U();return E.default=(0,m.default)((0,h.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Assignment"),E}var De=ze();const Se=O(De);var R={},ce;function Te(){if(ce)return R;ce=1;var s=W();Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var m=s(Z()),h=U();return R.default=(0,m.default)((0,h.jsx)("path",{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m13.5-9 1.96 2.5H17V9.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"LocalShipping"),R}var Me=Te();const qe=O(Me);var N={},de;function Be(){if(de)return N;de=1;var s=W();Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0;var m=s(Z()),h=U();return N.default=(0,m.default)((0,h.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile"),N}var Ve=Be();const Ae=O(Ve),Ee=s=>{switch(s){case"insurance_pzp":return{label:"Poistka - PZP",icon:e.jsx(J,{}),color:"#1976d2"};case"insurance_kasko":return{label:"Poistka - Kasko",icon:e.jsx(J,{}),color:"#2196f3"};case"insurance_pzp_kasko":return{label:"Poistka - PZP + Kasko",icon:e.jsx(J,{}),color:"#9c27b0"};case"stk":return{label:"STK",icon:e.jsx(Ie,{}),color:"#388e3c"};case"ek":return{label:"EK",icon:e.jsx(Se,{}),color:"#f57c00"};case"vignette":return{label:"Dialniƒçn√° zn√°mka",icon:e.jsx(qe,{}),color:"#7b1fa2"};case"insurance":return{label:"Poistka - PZP",icon:e.jsx(J,{}),color:"#1976d2"};default:return{label:"Dokument",icon:e.jsx(Ae,{}),color:"#666"}}};function Ze({document:s,onSave:m,onCancel:h}){const{state:b}=fe(),[K,w]=v.useState(!1),[r,l]=v.useState(()=>{const t={vehicleId:s?.vehicleId||"",type:s?.type||"insurance_pzp",policyNumber:s?.policyNumber||"",company:s?.company||"",paymentFrequency:s?.paymentFrequency||"yearly",documentNumber:s?.documentNumber||"",notes:s?.notes||"",validFrom:s?.validFrom||new Date,validTo:s?.validTo||new Date,price:s?.price||0,filePath:s?.filePath||"",filePaths:s?.filePaths||[],greenCardValidFrom:s?.greenCardValidFrom||void 0,greenCardValidTo:s?.greenCardValidTo||void 0,kmState:s?.kmState||void 0};if(!s&&(t.type==="insurance_pzp"||t.type==="insurance_kasko"||t.type==="insurance_pzp_kasko")&&t.validFrom){const a=(()=>{const i=new Date(t.validFrom),n=new Date(i);return n.setFullYear(n.getFullYear()+1),n.setDate(n.getDate()-1),n})();t.validTo=a}return t}),[Q,P]=v.useState(!1),[I,k]=v.useState(""),[u,H]=v.useState({}),M=(t,a)=>{if(!t)return new Date;const i=new Date(t),n=new Date(i);switch(a){case"monthly":n.setMonth(n.getMonth()+1);break;case"quarterly":n.setMonth(n.getMonth()+3);break;case"biannual":n.setMonth(n.getMonth()+6);break;case"yearly":n.setFullYear(n.getFullYear()+1);break;default:n.setFullYear(n.getFullYear()+1)}return n.setDate(n.getDate()-1),n};v.useEffect(()=>{if((r.type==="insurance_pzp"||r.type==="insurance_kasko"||r.type==="insurance_pzp_kasko")&&r.validFrom&&r.paymentFrequency){const t=M(r.validFrom,r.paymentFrequency);l(a=>({...a,validTo:t}))}},[r.validFrom,r.paymentFrequency,r.type]),v.useEffect(()=>{(r.type==="insurance_pzp"||r.type==="insurance_pzp_kasko")&&r.validFrom&&r.validTo&&!K&&!s&&l(t=>({...t,greenCardValidFrom:r.validFrom,greenCardValidTo:r.validTo}))},[r.validFrom,r.validTo,r.type,s,K]),v.useEffect(()=>{s&&l({id:s.id,vehicleId:s.vehicleId,type:s.type,policyNumber:s.policyNumber||"",company:s.company||"",paymentFrequency:s.paymentFrequency||"yearly",documentNumber:s.documentNumber||"",notes:s.notes||"",validFrom:s.validFrom,validTo:s.validTo,price:s.price||0,filePath:s.filePath||"",greenCardValidFrom:s.greenCardValidFrom,greenCardValidTo:s.greenCardValidTo})},[s]);const L=()=>{const t={};return r.vehicleId||(t.vehicleId="Vozidlo je povinn√©"),r.validTo||(t.validTo="D√°tum platnosti do je povinn√Ω"),(r.type==="insurance_pzp"||r.type==="insurance_kasko"||r.type==="insurance_pzp_kasko")&&(r.policyNumber||(t.policyNumber="ƒå√≠slo poistky je povinn√©"),r.company||(t.company="Pois≈•ov≈àa je povinn√°")),r.price&&r.price<0&&(t.price="Cena nem√¥≈æe by≈• z√°porn√°"),H(t),Object.keys(t).length===0},q=t=>{if(Array.isArray(t)){const a=t.map(i=>i.url);l(i=>{const n=i.filePaths||[],c=[...n,...a];return{...i,filePaths:c,filePath:n.length>0?i.filePath:c[0]}})}else l(a=>{const i=a.filePaths||[],n=[...i,t.url];return{...a,filePaths:n,filePath:i.length>0?a.filePath:t.url}})},z=t=>{t.preventDefault(),L()&&m(r)},j=Ee(r.type),g=r.type==="insurance_pzp"||r.type==="insurance_kasko"||r.type==="insurance_pzp_kasko",X=r.type==="insurance_pzp"||r.type==="insurance_pzp_kasko",B=r.type==="insurance_kasko"||r.type==="insurance_pzp_kasko",ee=r.type==="insurance_kasko"||r.type==="insurance_pzp_kasko"||r.type==="stk"||r.type==="ek";return e.jsxs(e.Fragment,{children:[e.jsx("form",{onSubmit:z,children:e.jsxs(p,{sx:{p:3},children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:1,mb:3},children:[j.icon,e.jsxs(d,{variant:"h6",sx:{color:j.color},children:[s?.id?"Upravi≈•":"Prida≈•"," ",j.label]})]}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(_,{children:e.jsxs(F,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Z√°kladn√© inform√°cie"}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:12,sm:6,children:[e.jsx(ke,{fullWidth:!0,options:(b.vehicles||[]).slice().sort((t,a)=>{const i=`${t.brand} ${t.model} (${t.licensePlate})`,n=`${a.brand} ${a.model} (${a.licensePlate})`;return i.localeCompare(n,"sk",{sensitivity:"base"})}),getOptionLabel:t=>`${t.brand} ${t.model} (${t.licensePlate})`,value:(b.vehicles||[]).find(t=>t.id===r.vehicleId)||null,onChange:(t,a)=>l(i=>({...i,vehicleId:a?.id||""})),renderInput:t=>e.jsx(C,{...t,label:"Vozidlo",required:!0,error:!!u.vehicleId,placeholder:"Zaƒçnite p√≠sa≈• pre vyhƒæadanie vozidla..."}),noOptionsText:"≈Ωiadne vozidl√° nen√°jden√©",filterOptions:(t,{inputValue:a})=>t.filter(n=>`${n.brand} ${n.model} ${n.licensePlate}`.toLowerCase().includes(a.toLowerCase()))}),u.vehicleId&&e.jsx(d,{variant:"caption",color:"error",sx:{mt:.5,display:"block"},children:u.vehicleId})]}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(te,{fullWidth:!0,required:!0,children:[e.jsx(re,{children:"Typ dokumentu"}),e.jsxs(ae,{value:r.type,label:"Typ dokumentu",onChange:t=>l(a=>({...a,type:t.target.value})),children:[e.jsx(x,{value:"insurance_pzp",children:"Poistka - PZP"}),e.jsx(x,{value:"insurance_kasko",children:"Poistka - Kasko"}),e.jsx(x,{value:"insurance_pzp_kasko",children:"Poistka - PZP + Kasko"}),e.jsx(x,{value:"stk",children:"STK"}),e.jsx(x,{value:"ek",children:"EK"}),e.jsx(x,{value:"vignette",children:"Dialniƒçn√° zn√°mka"})]})]})}),g&&e.jsxs(e.Fragment,{children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(C,{fullWidth:!0,required:!0,label:"ƒå√≠slo poistky",value:r.policyNumber,onChange:t=>l(a=>({...a,policyNumber:t.target.value})),error:!!u.policyNumber,helperText:u.policyNumber})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(te,{fullWidth:!0,required:!0,error:!!u.company,children:[e.jsx(re,{children:"Pois≈•ov≈àa"}),e.jsxs(ae,{value:r.company,label:"Pois≈•ov≈àa",onChange:t=>{const a=t.target.value;a==="__add_new__"?P(!0):l(i=>({...i,company:a}))},children:[b.insurers.map(t=>e.jsx(x,{value:t.name,children:t.name},t.id)),e.jsx(x,{value:"__add_new__",children:e.jsx("em",{children:"+ Prida≈• nov√∫ pois≈•ov≈àu"})})]}),u.company&&e.jsx(d,{variant:"caption",color:"error",sx:{mt:.5,ml:1},children:u.company})]})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(te,{fullWidth:!0,children:[e.jsx(re,{children:"Frekvencia platenia"}),e.jsxs(ae,{value:r.paymentFrequency,label:"Frekvencia platenia",onChange:t=>l(a=>({...a,paymentFrequency:t.target.value})),children:[e.jsx(x,{value:"monthly",children:"Mesaƒçne (platnos≈• +1 mesiac)"}),e.jsx(x,{value:"quarterly",children:"≈†tvr≈•roƒçne (platnos≈• +3 mesiace)"}),e.jsx(x,{value:"biannual",children:"Polroƒçne (platnos≈• +6 mesiacov)"}),e.jsx(x,{value:"yearly",children:"Roƒçne (platnos≈• +1 rok)"})]})]})})]})]})]})})}),X&&e.jsx(o,{item:!0,xs:12,children:e.jsx(_,{children:e.jsxs(F,{children:[e.jsxs(d,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:["üü¢ Platnos≈• bielej karty",e.jsx(ne,{size:"small",label:"Automatick√©",color:"success",variant:"outlined"})]}),e.jsx($,{severity:"info",sx:{mb:2},children:e.jsx(d,{variant:"body2",children:"üí° Platnos≈• zelenej karty sa automaticky nastav√≠ podƒæa platnosti poistky. M√¥≈æete ju v≈°ak upravi≈• podƒæa potreby."})}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(Y,{label:"Biela karta platn√° od",value:r.greenCardValidFrom?new Date(r.greenCardValidFrom):null,onChange:t=>{l(a=>({...a,greenCardValidFrom:t||void 0})),w(!0)},slotProps:{textField:{fullWidth:!0,placeholder:"Automaticky nastaven√©"}}})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(Y,{label:"Biela karta platn√° do",value:r.greenCardValidTo?new Date(r.greenCardValidTo):null,onChange:t=>{l(a=>({...a,greenCardValidTo:t||void 0})),w(!0)},slotProps:{textField:{fullWidth:!0,placeholder:"Automaticky nastaven√©"}}})})]})]})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(_,{children:e.jsxs(F,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Platnos≈• a cena"}),g&&e.jsx($,{severity:"info",sx:{mb:2},children:e.jsxs(d,{variant:"body2",children:["üí° ",e.jsx("strong",{children:"Automatick√© dopƒ∫≈àanie:"}),' D√°tum "Platn√© do" sa automaticky vypoƒç√≠ta na z√°kladƒõ d√°tumu "Platn√© od" a frekvencie platenia.']})}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(Y,{label:"Platn√© od",value:r.validFrom?new Date(r.validFrom):null,onChange:t=>l(a=>({...a,validFrom:t||void 0})),slotProps:{textField:{fullWidth:!0}}})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(Y,{label:g?"Platn√© do (automaticky)":"Platn√© do",value:r.validTo?new Date(r.validTo):new Date,onChange:t=>l(a=>({...a,validTo:t||new Date})),readOnly:g,slotProps:{textField:{fullWidth:!0,required:!0,error:!!u.validTo,helperText:g?"Automaticky vypoƒç√≠tan√© podƒæa frekvencie platenia":u.validTo,InputProps:g?{style:{backgroundColor:"#f5f5f5",color:"#666"}}:void 0}}})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(C,{fullWidth:!0,type:"number",label:"Cena (‚Ç¨)",value:r.price||"",onChange:t=>l(a=>({...a,price:parseFloat(t.target.value)||0})),error:!!u.price,helperText:u.price,inputProps:{step:.01,min:0}})})]})]})})}),ee&&e.jsx(o,{item:!0,xs:12,children:e.jsx(_,{children:e.jsxs(F,{children:[e.jsxs(d,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:["üöó Stav kilometrov",e.jsx(ne,{size:"small",label:B?"Kasko":"Kontrola",color:B?"info":"success",variant:"outlined"})]}),e.jsx($,{severity:"info",sx:{mb:2},children:e.jsxs(d,{variant:"body2",children:["üí° ",B?"Zadajte stav kilometrov pri uzatv√°ran√≠ Kasko poistky pre evidenciu.":"Zadajte stav kilometrov pri STK/EK kontrole."]})}),e.jsx(o,{container:!0,spacing:2,children:e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(C,{fullWidth:!0,type:"number",label:"Stav kilometrov",value:r.kmState||"",onChange:t=>l(a=>({...a,kmState:parseInt(t.target.value)||void 0})),placeholder:"Napr√≠klad: 125000",helperText:"Zadajte aktu√°lny stav kilometrov",inputProps:{min:0,step:1},InputProps:{endAdornment:e.jsx(d,{variant:"body2",color:"text.secondary",children:"km"})}})})})]})})}),!g&&e.jsx(o,{item:!0,xs:12,children:e.jsx(_,{children:e.jsxs(F,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Dodatoƒçn√© inform√°cie"}),e.jsx(o,{container:!0,spacing:2,children:e.jsxs(e.Fragment,{children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(C,{fullWidth:!0,label:"ƒå√≠slo dokumentu",value:r.documentNumber,onChange:t=>l(a=>({...a,documentNumber:t.target.value})),placeholder:"Napr√≠klad: ABC123456",helperText:"Zadajte ƒç√≠slo dokumentu alebo poistky"})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(C,{fullWidth:!0,multiline:!0,rows:3,label:"Pozn√°mky",value:r.notes,onChange:t=>l(a=>({...a,notes:t.target.value}))})})]})})]})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(_,{children:e.jsxs(F,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Prilo≈æen√Ω s√∫bor"}),r.filePaths&&r.filePaths.length>0&&e.jsx($,{severity:"info",sx:{mb:2},children:r.filePaths.length===1?"S√∫bor u≈æ je prilo≈æen√Ω. M√¥≈æete prida≈• viac s√∫borov.":`${r.filePaths.length} s√∫borov je u≈æ prilo≈æen√Ωch. M√¥≈æete prida≈• viac s√∫borov.`}),e.jsx(Pe,{type:"document",entityId:r.vehicleId||"temp",onUploadSuccess:q,onUploadError:t=>console.error("Upload error:",t),acceptedTypes:["image/jpeg","image/png","image/webp","application/pdf"],maxSize:10,multiple:!0,label:"Nahra≈• s√∫bory (PDF, JPG, PNG) - m√¥≈æete vybra≈• viacero"}),r.filePaths&&r.filePaths.length>0&&e.jsxs(p,{sx:{mt:2},children:[e.jsxs(d,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Prilo≈æen√© s√∫bory (",r.filePaths.length,"):"]}),e.jsx(p,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:r.filePaths.map((t,a)=>e.jsx(ne,{label:`${a+1}. ${t.split("/").pop()}`,onClick:()=>window.open(t,"_blank"),onDelete:()=>{l(i=>{const n=i.filePaths?.filter((c,D)=>D!==a)||[];return{...i,filePaths:n,filePath:n[0]||""}})},size:"small",variant:"outlined",sx:{cursor:"pointer"}},a))})]})]})})})]}),e.jsx(je,{sx:{my:3}}),e.jsxs(p,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(G,{variant:"outlined",onClick:h,children:"Zru≈°i≈•"}),e.jsx(G,{type:"submit",variant:"contained",sx:{background:`linear-gradient(135deg, ${j.color} 0%, ${j.color}dd 100%)`,"&:hover":{background:`linear-gradient(135deg, ${j.color}dd 0%, ${j.color}bb 100%)`}},children:s?.id?"Ulo≈æi≈• zmeny":"Prida≈• dokument"})]})]})}),Q&&e.jsx(p,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>P(!1),children:e.jsx(_,{sx:{minWidth:400,m:2},onClick:t=>t.stopPropagation(),children:e.jsxs(F,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Prida≈• nov√∫ pois≈•ov≈àu"}),e.jsx(C,{fullWidth:!0,label:"N√°zov pois≈•ovne",value:I,onChange:t=>k(t.target.value),margin:"normal",autoFocus:!0}),e.jsxs(p,{sx:{display:"flex",gap:1,mt:2,justifyContent:"flex-end"},children:[e.jsx(G,{onClick:()=>{P(!1),k("")},children:"Zru≈°i≈•"}),e.jsx(G,{variant:"contained",onClick:async()=>{if(I.trim())try{const a=await fetch("https://blackrent-app-production-4d6f.up.railway.app/api/insurers",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("blackrent_token")||sessionStorage.getItem("blackrent_token")}`},body:JSON.stringify({name:I.trim()})});if(a.ok){const i=await a.json();l(n=>({...n,company:I.trim()})),P(!1),k(""),window.location.reload()}else console.error("‚ùå Chyba pri vytv√°ran√≠ poistovne:",a.statusText)}catch(t){console.error("‚ùå Chyba pri prid√°van√≠ poistovne:",t)}},disabled:!I.trim(),children:"Prida≈•"})]})]})})})]})}export{Pe as R,Ze as U};
