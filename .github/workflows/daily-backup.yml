name: Daily Railway Backup

on:
  schedule:
    # KaÅ¾dÃ½ deÅˆ o 2:00 UTC (3:00 CET)
    - cron: '0 2 * * *'
  workflow_dispatch: # UmoÅ¾nÃ­ manuÃ¡lne spustenie

jobs:
  backup:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Railway CLI
        run: |
          curl -fsSL https://railway.app/install.sh | sh
          echo "$HOME/.railway/bin" >> $GITHUB_PATH

      - name: Run Railway Backup
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
        run: |
          echo "ðŸ”— Linking to Railway project..."
          railway link --project 38dbf675-5b8e-489d-b1e0-e727883208ce
          echo "ðŸš€ Running backup script..."
          cd scripts/backup
          railway run node railway-cron-backup.js

      - name: Backup Status
        run: |
          echo "âœ… Daily backup completed successfully!"
          echo "ðŸ“… Date: $(date)"
          echo "ðŸ”— Check R2 Storage for backup files"
